<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Human Design Profile | Lee Foropoulos</title>
  <meta name="description" content="Explore Lee Foropoulos's Human Design - Manifesting Generator 6/2 with emotional authority and a purpose-driven approach to leadership.">
  <meta name="ambient:music" content="acoustic-jazz">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            navy: { 900: '#0f172a', 800: '#1e293b', 700: '#334155', 600: '#475569' },
            gold: { 700: '#b45309', 600: '#d97706', 500: '#f59e0b', 400: '#fbbf24', 300: '#fcd34d', 200: '#fde68a', 100: '#fef3c7', 50: '#fffbeb' },
            amber: { 500: '#f59e0b', 400: '#fbbf24' }
          },
          fontFamily: { sans: ['Inter', 'system-ui', 'sans-serif'] }
        }
      }
    }
  </script>
  <script>
    (function() {
      function getCookie(name) {
        const match = document.cookie.match(new RegExp('(^| )' + name + '=([^;]+)'));
        return match ? match[2] : null;
      }
      const darkPref = getCookie('darkMode');
      if (darkPref === 'true' || (!darkPref && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
        document.documentElement.classList.add('dark');
      }
    })();
  </script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  <style>
    html { scroll-behavior: smooth; }
    body { font-family: 'Inter', system-ui, sans-serif; }
    .gradient-text { background: linear-gradient(135deg, #f59e0b, #fbbf24); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; }
    .hero-gradient { background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f172a 100%); }
    .card-hover { transition: all 0.3s ease; }
    .card-hover:hover { transform: translateY(-4px); box-shadow: 0 12px 24px rgba(0,0,0,0.15); }
    .dark .card-hover:hover { box-shadow: 0 12px 24px rgba(0,0,0,0.4); }
    .mobile-menu { transform: translateX(100%); transition: transform 0.3s ease; }
    .mobile-menu.open { transform: translateX(0); }
    .mobile-overlay { opacity: 0; visibility: hidden; transition: all 0.3s ease; }
    .mobile-overlay.open { opacity: 1; visibility: visible; }

    /* Scroll Progress Bar */
    .scroll-progress { position: fixed; top: 0; left: 0; height: 3px; background: linear-gradient(90deg, #f59e0b, #fbbf24); z-index: 100; width: 0%; transition: width 0.1s ease-out; }

    /* Scroll Reveal Animations */
    .reveal { opacity: 0; transform: translateY(30px); transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1); }
    .reveal.active, .reveal.visible { opacity: 1; transform: translateY(0); }
    .reveal-left { opacity: 0; transform: translateX(-30px); transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1); }
    .reveal-left.active, .reveal-left.visible { opacity: 1; transform: translateX(0); }
    .reveal-right { opacity: 0; transform: translateX(30px); transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1); }
    .reveal-right.active, .reveal-right.visible { opacity: 1; transform: translateX(0); }
    .reveal-scale { opacity: 0; transform: scale(0.9); transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1); }
    .reveal-scale.active, .reveal-scale.visible { opacity: 1; transform: scale(1); }

    /* Back to Top Button */
    .back-to-top { opacity: 0; visibility: hidden; transition: all 0.3s ease; }
    .back-to-top.visible { opacity: 1; visibility: visible; }

    /* Card Stagger Animation */
    .stagger-1 { transition-delay: 0.1s; }
    .stagger-2 { transition-delay: 0.2s; }
    .stagger-3 { transition-delay: 0.3s; }
    .stagger-4 { transition-delay: 0.4s; }
    .stagger-5 { transition-delay: 0.5s; }
  </style>
  <!-- Analytics: Google Analytics 4 + Microsoft Clarity -->
  <script src="/analytics.js" defer></script>
</head>
<body class="bg-white dark:bg-navy-900 text-gray-800 dark:text-gray-200 transition-colors">

  <!-- Scroll Progress Bar -->
  <div class="scroll-progress" id="scroll-progress"></div>

  <!-- Navigation -->
  <nav class="fixed top-0 left-0 right-0 z-50 bg-navy-900/95 backdrop-blur-md border-b border-white/10">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center h-16">
        <a href="../" class="text-white font-bold text-xl tracking-tight">Foropoulos<span class="text-gold-400">Now</span><span class="text-gray-400 text-sm">.com</span></a>
        <div class="hidden md:flex items-center space-x-8">
          <a href="../" class="text-gray-300 hover:text-gold-400 transition">Home</a>
          <a href="Lee_Foropoulos_DISC_Profile" class="text-gray-300 hover:text-gold-400 transition">DISC</a>
          <a href="Lee_Foropoulos_MBTI" class="text-gray-300 hover:text-gold-400 transition">MBTI</a>
          <a href="Lee_Foropoulos_Big_Five" class="text-gray-300 hover:text-gold-400 transition">Big Five</a>
          <a href="Lee_Foropoulos_Human_Design_Profile" class="text-gold-400 font-semibold">Human Design</a>
          <!-- Dark Mode Toggle -->
          <button id="dark-toggle" class="p-2 rounded-lg bg-white/10 hover:bg-white/20 transition" title="Toggle dark mode">
            <svg id="sun-icon" class="w-5 h-5 text-gold-400 hidden" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd"></path></svg>
            <svg id="moon-icon" class="w-5 h-5 text-gold-400" fill="currentColor" viewBox="0 0 20 20"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg>
          </button>
          <a href="https://www.upwork.com/freelancers/thesecretchief?viewMode=1" target="_blank" class="bg-gold-500 hover:bg-gold-400 text-navy-900 font-semibold px-5 py-2 rounded-full transition">Work With Me</a>
        </div>
        <button id="mobile-menu-btn" class="md:hidden text-white p-2">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
        </button>
      </div>
    </div>
    <!-- Mobile Overlay -->
    <div id="mobile-overlay" class="mobile-overlay fixed inset-0 bg-black/50 md:hidden"></div>
    <!-- Mobile Menu -->
    <div id="mobile-menu" class="mobile-menu fixed top-0 right-0 h-full w-72 bg-navy-900 shadow-2xl md:hidden">
      <div class="p-6">
        <button id="close-menu" class="absolute top-4 right-4 text-white p-2">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
        </button>
        <div class="mt-12 flex flex-col space-y-6">
          <a href="../" class="text-white text-lg hover:text-gold-400 transition">Home</a>
          <a href="Lee_Foropoulos_DISC_Profile" class="text-white text-lg hover:text-gold-400 transition">DISC</a>
          <a href="Lee_Foropoulos_MBTI" class="text-white text-lg hover:text-gold-400 transition">MBTI</a>
          <a href="Lee_Foropoulos_Big_Five" class="text-white text-lg hover:text-gold-400 transition">Big Five</a>
          <a href="Lee_Foropoulos_Human_Design_Profile" class="text-gold-400 text-lg font-semibold">Human Design</a>
          <hr class="border-white/20">
          <!-- Mobile Dark Mode Toggle -->
          <button id="mobile-dark-toggle" class="flex items-center gap-3 text-white text-lg hover:text-gold-400 transition">
            <svg id="mobile-sun-icon" class="w-5 h-5 hidden" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd"></path></svg>
            <svg id="mobile-moon-icon" class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg>
            <span id="dark-mode-text">Light Mode</span>
          </button>
          <hr class="border-white/20">
          <a href="https://www.upwork.com/freelancers/thesecretchief?viewMode=1" target="_blank" class="bg-gold-500 text-navy-900 font-semibold px-5 py-3 rounded-full text-center transition hover:bg-gold-400">Work With Me</a>
        </div>
      </div>
    </div>
  </nav>

  <!-- Hero Section -->
  <section class="hero-gradient pt-24 pb-16">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center reveal">
        <div class="inline-flex items-center gap-2 bg-gold-500/10 border border-gold-500/20 rounded-full px-4 py-2 mb-6">
          <span class="text-2xl">&#128302;</span>
          <span class="text-gold-400 font-medium">Energetic Blueprint</span>
        </div>
        <h1 class="text-4xl sm:text-5xl lg:text-6xl font-bold text-white mb-4">
          My <span class="gradient-text">Human Design</span>
        </h1>
        <p class="text-2xl text-gray-300 mb-6">Manifesting Generator | 6/2 Profile</p>
        <p class="text-xl text-gray-400 max-w-3xl mx-auto leading-relaxed">
          A dynamic, multi-talented blueprint designed to respond to opportunities with sustained energy, adaptability, and intuitive leadership.
        </p>
      </div>
    </div>
  </section>

  <!-- What is Human Design Section -->
  <section class="py-16 bg-white dark:bg-navy-900 transition-colors">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-12 reveal">
        <h2 class="text-3xl font-bold text-navy-900 dark:text-white mb-4">What is Human Design?</h2>
        <p class="text-lg text-gray-600 dark:text-gray-300 leading-relaxed">
          Human Design is a sophisticated system integrating principles from astrology, the I Ching, Kabbalah, the Hindu-Brahmin chakra system, and quantum mechanics. It reveals innate strengths, decision-making strategies, and life purpose, offering a framework to align professional endeavors with natural tendencies.
        </p>
      </div>
      <div class="bg-gray-50 dark:bg-navy-800 rounded-2xl p-6 text-center reveal border border-gray-100 dark:border-white/10">
        <p class="text-gray-600 dark:text-gray-300 mb-2">
          Discover your own Human Design chart at
          <a href="https://ahumandesign.com/human-design-chart/" target="_blank" class="text-gold-500 hover:text-gold-400 font-semibold underline">aHumanDesign.com</a>
        </p>
        <p class="text-gray-500 dark:text-gray-400 text-sm">
          <a href="https://youtu.be/MP6Jns365J4?si=1norZw9pZljaXi79" target="_blank" class="text-gold-500 hover:text-gold-400 underline">Watch a tutorial to learn more</a>
        </p>
      </div>
    </div>
  </section>

  <!-- Chart Section -->
  <section class="py-16 bg-gray-50 dark:bg-navy-800 transition-colors">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="grid lg:grid-cols-2 gap-12 items-start">
        <div class="reveal-left">
          <div class="bg-white dark:bg-navy-900 rounded-2xl p-4 shadow-lg dark:shadow-2xl sticky top-24 border border-gray-100 dark:border-white/10">
            <img src="images/HumanDesign.png" alt="Lee Foropoulos Human Design Chart" class="w-full rounded-xl" onerror="this.src='https://via.placeholder.com/600x700.png?text=Human+Design+Chart';">
          </div>
        </div>
        <div class="space-y-6 reveal-right">
          <h2 class="text-3xl font-bold text-navy-900 dark:text-white mb-6">Core Attributes</h2>

          <div class="card-hover bg-white dark:bg-navy-900 rounded-2xl p-6 shadow-sm dark:shadow-lg border border-gray-100 dark:border-white/10 stagger-1 reveal">
            <div class="flex items-center gap-3 mb-3">
              <span class="text-2xl">&#9889;</span>
              <h3 class="text-lg font-bold text-navy-900 dark:text-white">Type: Manifesting Generator</h3>
            </div>
            <p class="text-gray-600 dark:text-gray-300 text-sm">A dynamic, multi-talented individual designed to respond to opportunities with sustained energy and adaptability. Thrives in fast-paced, innovative environments with versatility and efficiency.</p>
          </div>

          <div class="card-hover bg-white dark:bg-navy-900 rounded-2xl p-6 shadow-sm dark:shadow-lg border border-gray-100 dark:border-white/10 stagger-2 reveal">
            <div class="flex items-center gap-3 mb-3">
              <span class="text-2xl">&#127919;</span>
              <h3 class="text-lg font-bold text-navy-900 dark:text-white">Strategy: To Respond</h3>
            </div>
            <p class="text-gray-600 dark:text-gray-300 text-sm">Excelling by waiting for external cues—opportunities or challenges—before acting, ensuring energy aligns with meaningful outcomes and avoiding frustration.</p>
          </div>

          <div class="card-hover bg-white dark:bg-navy-900 rounded-2xl p-6 shadow-sm dark:shadow-lg border border-gray-100 dark:border-white/10 stagger-3 reveal">
            <div class="flex items-center gap-3 mb-3">
              <span class="text-2xl">&#128156;</span>
              <h3 class="text-lg font-bold text-navy-900 dark:text-white">Inner Authority: Emotional - Solar Plexus</h3>
            </div>
            <p class="text-gray-600 dark:text-gray-300 text-sm">Decisions guided by emotional clarity, achieved by allowing emotional waves to settle over time. This ensures sustainable, impactful choices in strategic leadership roles.</p>
          </div>

          <div class="card-hover bg-white dark:bg-navy-900 rounded-2xl p-6 shadow-sm dark:shadow-lg border border-gray-100 dark:border-white/10 stagger-4 reveal">
            <div class="flex items-center gap-3 mb-3">
              <span class="text-2xl">&#128279;</span>
              <h3 class="text-lg font-bold text-navy-900 dark:text-white">Definition: Split Definition</h3>
            </div>
            <p class="text-gray-600 dark:text-gray-300 text-sm">Energy centers divided into two unconnected areas, fostering a natural drive to collaborate and connect with others—adept at bridging gaps between teams and ideas.</p>
          </div>

          <div class="card-hover bg-white dark:bg-navy-900 rounded-2xl p-6 shadow-sm dark:shadow-lg border border-gray-100 dark:border-white/10 stagger-5 reveal">
            <div class="flex items-center gap-3 mb-3">
              <span class="text-2xl">&#128100;</span>
              <h3 class="text-lg font-bold text-navy-900 dark:text-white">Profile: 6/2 (Role Model/Hermit)</h3>
            </div>
            <p class="text-gray-600 dark:text-gray-300 text-sm">Life unfolds in three phases: experimentation (0–30), reflection (30–50), and role modeling (50+). Currently refining skills and preparing to mentor others, balancing leadership with introspection.</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Life Purpose Section -->
  <section class="py-16 bg-white dark:bg-navy-900 transition-colors">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <h2 class="text-3xl font-bold text-navy-900 dark:text-white text-center mb-12 reveal">Life Purpose & Dynamics</h2>
      <div class="grid md:grid-cols-3 gap-6">
        <div class="card-hover bg-gradient-to-br from-indigo-50 to-indigo-100 dark:from-indigo-900/30 dark:to-indigo-800/30 rounded-2xl p-8 border border-indigo-200 dark:border-indigo-500/30 reveal stagger-1">
          <div class="w-14 h-14 bg-indigo-500 rounded-xl flex items-center justify-center mb-4">
            <span class="text-2xl text-white">&#10010;</span>
          </div>
          <h3 class="text-lg font-bold text-navy-900 dark:text-white mb-2">Incarnation Cross</h3>
          <p class="text-sm text-indigo-600 dark:text-indigo-400 font-semibold mb-3">Left Angle Cross of Industry (29/30 | 20/34)</p>
          <p class="text-gray-600 dark:text-gray-300 text-sm">Purpose centers on dedication, perseverance, and impactful work that drives collective progress with passion and influence.</p>
        </div>

        <div class="card-hover bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/30 dark:to-green-800/30 rounded-2xl p-8 border border-green-200 dark:border-green-500/30 reveal stagger-2">
          <div class="w-14 h-14 bg-green-500 rounded-xl flex items-center justify-center mb-4">
            <span class="text-2xl text-white">&#10003;</span>
          </div>
          <h3 class="text-lg font-bold text-navy-900 dark:text-white mb-2">Signature</h3>
          <p class="text-sm text-green-600 dark:text-green-400 font-semibold mb-3">Satisfaction</p>
          <p class="text-gray-600 dark:text-gray-300 text-sm">When aligned with design—responding to opportunities and making emotionally clear decisions—I experience deep fulfillment.</p>
        </div>

        <div class="card-hover bg-gradient-to-br from-amber-50 to-amber-100 dark:from-amber-900/30 dark:to-amber-800/30 rounded-2xl p-8 border border-amber-200 dark:border-amber-500/30 reveal stagger-3">
          <div class="w-14 h-14 bg-amber-500 rounded-xl flex items-center justify-center mb-4">
            <span class="text-2xl text-white">&#9888;</span>
          </div>
          <h3 class="text-lg font-bold text-navy-900 dark:text-white mb-2">Not-Self Theme</h3>
          <p class="text-sm text-amber-600 dark:text-amber-400 font-semibold mb-3">Frustration</p>
          <p class="text-gray-600 dark:text-gray-300 text-sm">Misalignment—initiating without responding or rushing decisions—leads to frustration. A signal to realign with strategy and authority.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Unique Traits Section -->
  <section class="py-16 bg-navy-900">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <h2 class="text-3xl font-bold text-white text-center mb-12 reveal">Unique Traits & Environment</h2>
      <div class="grid sm:grid-cols-2 lg:grid-cols-5 gap-4">
        <div class="bg-white/5 backdrop-blur border border-white/10 rounded-xl p-6 text-center reveal stagger-1 card-hover">
          <div class="text-3xl mb-3">&#127869;</div>
          <h3 class="text-white font-semibold mb-2">Digestion</h3>
          <p class="text-gold-400 text-sm font-medium mb-2">Open</p>
          <p class="text-gray-400 text-xs">Flexible processing, benefits from consistent routines</p>
        </div>
        <div class="bg-white/5 backdrop-blur border border-white/10 rounded-xl p-6 text-center reveal stagger-2 card-hover">
          <div class="text-3xl mb-3">&#128065;</div>
          <h3 class="text-white font-semibold mb-2">Design Sense</h3>
          <p class="text-gold-400 text-sm font-medium mb-2">Outer Vision</p>
          <p class="text-gray-400 text-xs">Keen ability to observe patterns and possibilities</p>
        </div>
        <div class="bg-white/5 backdrop-blur border border-white/10 rounded-xl p-6 text-center reveal stagger-3 card-hover">
          <div class="text-3xl mb-3">&#128170;</div>
          <h3 class="text-white font-semibold mb-2">Motivation</h3>
          <p class="text-gold-400 text-sm font-medium mb-2">Fear</p>
          <p class="text-gray-400 text-xs">Driven to mitigate risks through thorough preparation</p>
        </div>
        <div class="bg-white/5 backdrop-blur border border-white/10 rounded-xl p-6 text-center reveal stagger-4 card-hover">
          <div class="text-3xl mb-3">&#128081;</div>
          <h3 class="text-white font-semibold mb-2">Perspective</h3>
          <p class="text-gold-400 text-sm font-medium mb-2">Power</p>
          <p class="text-gray-400 text-xs">Views world through influence and leadership lens</p>
        </div>
        <div class="bg-white/5 backdrop-blur border border-white/10 rounded-xl p-6 text-center reveal stagger-5 card-hover">
          <div class="text-3xl mb-3">&#127956;</div>
          <h3 class="text-white font-semibold mb-2">Environment</h3>
          <p class="text-gold-400 text-sm font-medium mb-2">Mountains</p>
          <p class="text-gray-400 text-xs">Thrives in elevated, quiet spaces for perspective</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Gates & Channels Section -->
  <section class="py-16 bg-gray-50 dark:bg-navy-800 transition-colors">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <h2 class="text-3xl font-bold text-navy-900 dark:text-white text-center mb-12 reveal">Gates & Channels</h2>
      <div class="grid md:grid-cols-2 gap-8">
        <div class="bg-white dark:bg-navy-900 rounded-2xl p-8 shadow-sm dark:shadow-lg border border-gray-100 dark:border-white/10 reveal-left">
          <h3 class="text-xl font-bold text-navy-900 dark:text-white mb-4">Active Gates</h3>
          <div class="flex flex-wrap gap-2">
            <span class="px-3 py-1 bg-gold-100 dark:bg-gold-500/20 text-gold-700 dark:text-gold-400 rounded-full text-sm">4 - Problem-solving</span>
            <span class="px-3 py-1 bg-gold-100 dark:bg-gold-500/20 text-gold-700 dark:text-gold-400 rounded-full text-sm">6 - Emotional boundaries</span>
            <span class="px-3 py-1 bg-gold-100 dark:bg-gold-500/20 text-gold-700 dark:text-gold-400 rounded-full text-sm">15 - Love for humanity</span>
            <span class="px-3 py-1 bg-gold-100 dark:bg-gold-500/20 text-gold-700 dark:text-gold-400 rounded-full text-sm">20 - Presence</span>
            <span class="px-3 py-1 bg-gold-100 dark:bg-gold-500/20 text-gold-700 dark:text-gold-400 rounded-full text-sm">26 - Integrity</span>
            <span class="px-3 py-1 bg-gold-100 dark:bg-gold-500/20 text-gold-700 dark:text-gold-400 rounded-full text-sm">29 - Commitment</span>
            <span class="px-3 py-1 bg-gold-100 dark:bg-gold-500/20 text-gold-700 dark:text-gold-400 rounded-full text-sm">30 - Emotions</span>
            <span class="px-3 py-1 bg-gold-100 dark:bg-gold-500/20 text-gold-700 dark:text-gold-400 rounded-full text-sm">32 - Continuity</span>
            <span class="px-3 py-1 bg-gold-100 dark:bg-gold-500/20 text-gold-700 dark:text-gold-400 rounded-full text-sm">34 - Strength</span>
            <span class="px-3 py-1 bg-gold-100 dark:bg-gold-500/20 text-gold-700 dark:text-gold-400 rounded-full text-sm">35 - Change</span>
            <span class="px-3 py-1 bg-gold-100 dark:bg-gold-500/20 text-gold-700 dark:text-gold-400 rounded-full text-sm">39 - Provocation</span>
            <span class="px-3 py-1 bg-gold-100 dark:bg-gold-500/20 text-gold-700 dark:text-gold-400 rounded-full text-sm">40 - Willpower</span>
            <span class="px-3 py-1 bg-gold-100 dark:bg-gold-500/20 text-gold-700 dark:text-gold-400 rounded-full text-sm">43 - Insights</span>
            <span class="px-3 py-1 bg-gold-100 dark:bg-gold-500/20 text-gold-700 dark:text-gold-400 rounded-full text-sm">47 - Mental realization</span>
            <span class="px-3 py-1 bg-gold-100 dark:bg-gold-500/20 text-gold-700 dark:text-gold-400 rounded-full text-sm">49 - Transformation</span>
            <span class="px-3 py-1 bg-gold-100 dark:bg-gold-500/20 text-gold-700 dark:text-gold-400 rounded-full text-sm">57 - Intuition</span>
            <span class="px-3 py-1 bg-gold-100 dark:bg-gold-500/20 text-gold-700 dark:text-gold-400 rounded-full text-sm">58 - Vitality</span>
            <span class="px-3 py-1 bg-gold-100 dark:bg-gold-500/20 text-gold-700 dark:text-gold-400 rounded-full text-sm">59 - Intimacy</span>
            <span class="px-3 py-1 bg-gold-100 dark:bg-gold-500/20 text-gold-700 dark:text-gold-400 rounded-full text-sm">64 - Inspiration</span>
          </div>
        </div>
        <div class="bg-white dark:bg-navy-900 rounded-2xl p-8 shadow-sm dark:shadow-lg border border-gray-100 dark:border-white/10 reveal-right">
          <h3 class="text-xl font-bold text-navy-900 dark:text-white mb-4">Defined Channels</h3>
          <div class="space-y-4">
            <div class="p-4 bg-gray-50 dark:bg-navy-800 rounded-xl border border-gray-100 dark:border-white/5">
              <p class="font-semibold text-navy-900 dark:text-white">64-47: Abstract Thinking</p>
              <p class="text-gray-600 dark:text-gray-400 text-sm">Synthesizing insights into wisdom</p>
            </div>
            <div class="p-4 bg-gray-50 dark:bg-navy-800 rounded-xl border border-gray-100 dark:border-white/5">
              <p class="font-semibold text-navy-900 dark:text-white">57-20: Intuition to Expression</p>
              <p class="text-gray-600 dark:text-gray-400 text-sm">Clear, intuitive communication</p>
            </div>
            <div class="p-4 bg-gray-50 dark:bg-navy-800 rounded-xl border border-gray-100 dark:border-white/5">
              <p class="font-semibold text-navy-900 dark:text-white">20-34: Charisma</p>
              <p class="text-gray-600 dark:text-gray-400 text-sm">Influential presence and action</p>
            </div>
            <div class="p-4 bg-gray-50 dark:bg-navy-800 rounded-xl border border-gray-100 dark:border-white/5">
              <p class="font-semibold text-navy-900 dark:text-white">57-34: Power through Intuition</p>
              <p class="text-gray-600 dark:text-gray-400 text-sm">Decisive, instinct-driven action</p>
            </div>
            <div class="p-4 bg-gray-50 dark:bg-navy-800 rounded-xl border border-gray-100 dark:border-white/5">
              <p class="font-semibold text-navy-900 dark:text-white">59-6: Intimacy and Bonding</p>
              <p class="text-gray-600 dark:text-gray-400 text-sm">Deep, meaningful connections</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Other Profiles Section -->
  <section class="py-16 bg-white dark:bg-navy-900 transition-colors">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <h2 class="text-3xl font-bold text-navy-900 dark:text-white text-center mb-4 reveal">Explore My Other Profiles</h2>
      <p class="text-gray-600 dark:text-gray-400 text-center mb-12 max-w-2xl mx-auto reveal">Get a complete picture of how I think, lead, and collaborate</p>
      <div class="grid sm:grid-cols-3 gap-6">
        <a href="Lee_Foropoulos_DISC_Profile" class="card-hover bg-gray-50 dark:bg-navy-800 rounded-2xl p-8 text-center border border-gray-100 dark:border-white/10 reveal stagger-1">
          <div class="text-4xl mb-4">&#127919;</div>
          <h3 class="text-xl font-bold text-navy-900 dark:text-white mb-2">DISC Profile</h3>
          <p class="text-gray-500 dark:text-gray-400 text-sm mb-4">Balanced, versatile leadership</p>
          <span class="text-gold-500 font-medium">View Profile &rarr;</span>
        </a>
        <a href="Lee_Foropoulos_MBTI" class="card-hover bg-gray-50 dark:bg-navy-800 rounded-2xl p-8 text-center border border-gray-100 dark:border-white/10 reveal stagger-2">
          <div class="text-4xl mb-4">&#129504;</div>
          <h3 class="text-xl font-bold text-navy-900 dark:text-white mb-2">MBTI (ENTJ)</h3>
          <p class="text-gray-500 dark:text-gray-400 text-sm mb-4">The Commander - Natural leader</p>
          <span class="text-gold-500 font-medium">View Profile &rarr;</span>
        </a>
        <a href="Lee_Foropoulos_Big_Five" class="card-hover bg-gray-50 dark:bg-navy-800 rounded-2xl p-8 text-center border border-gray-100 dark:border-white/10 reveal stagger-3">
          <div class="text-4xl mb-4">&#11088;</div>
          <h3 class="text-xl font-bold text-navy-900 dark:text-white mb-2">Big Five Traits</h3>
          <p class="text-gray-500 dark:text-gray-400 text-sm mb-4">Core personality dimensions</p>
          <span class="text-gold-500 font-medium">View Profile &rarr;</span>
        </a>
      </div>
    </div>
  </section>

  <!-- CTA Section -->
  <section class="py-20 hero-gradient">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center reveal-scale">
      <h2 class="text-3xl sm:text-4xl font-bold text-white mb-6">Leverage My Human Design</h2>
      <p class="text-xl text-gray-300 mb-10 leading-relaxed">
        As a Manifesting Generator with a 6/2 Profile, I bring intuitive clarity, emotional intelligence, and a proven ability to lead with impact. Let's discuss how I can contribute to your success.
      </p>
      <a href="https://www.upwork.com/freelancers/thesecretchief?viewMode=1" target="_blank" class="inline-block bg-gold-500 hover:bg-gold-400 text-navy-900 font-bold px-10 py-4 rounded-full text-lg transition transform hover:scale-105">
        Let's Work Together
      </a>
    </div>
  </section>

  <!-- Footer -->
  <footer class="bg-navy-900 border-t border-white/10 py-12">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="grid md:grid-cols-3 gap-8 items-center">
        <div>
          <a href="../" class="text-white font-bold text-2xl tracking-tight">Foropoulos<span class="text-gold-400">Now</span><span class="text-gray-400 text-sm">.com</span></a>
          <p class="text-gray-400 mt-2">Fractional CTO & Program Manager</p>
        </div>
        <div class="text-center">
          <p class="text-gray-400">Get your own Human Design:</p>
          <a href="https://ahumandesign.com/human-design-chart/" target="_blank" class="text-gold-400 hover:text-gold-300 font-medium">aHumanDesign.com</a>
        </div>
        <div class="text-center md:text-right">
          <p class="text-gray-400">&copy; 2026 Greek-Fire Corporation</p>
          <a href="https://www.upwork.com/agencies/1699047706469380096/" target="_blank" class="text-gold-400 hover:text-gold-300 transition text-sm">Greek-Fire Corporation</a>
        </div>
      </div>
    </div>
  
    <!-- Legal Links -->
<div class="mt-8 pt-6 border-t border-white/10 flex flex-wrap justify-center gap-4 text-sm">
  <button id="cookie-settings-btn" class="text-gray-500 hover:text-gold-400 transition">Cookie Settings</button>
  <span class="text-gray-600">|</span>
  <a href="../privacy" class="text-gray-500 hover:text-gold-400 transition">Privacy Policy</a>
</div>
  </footer>

  <!-- Back to Top Button -->
  <button id="back-to-top" class="back-to-top fixed bottom-8 right-8 w-12 h-12 bg-gold-500 hover:bg-gold-400 text-navy-900 rounded-full shadow-lg flex items-center justify-center transition transform hover:scale-110 z-50">
    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18"></path></svg>
  </button>

  <script>
    // Mobile Menu
    const mobileMenuBtn = document.getElementById('mobile-menu-btn');
    const closeMenuBtn = document.getElementById('close-menu');
    const mobileMenu = document.getElementById('mobile-menu');
    const mobileOverlay = document.getElementById('mobile-overlay');

    function openMenu() {
      if (mobileMenu) mobileMenu.classList.add('open');
      if (mobileOverlay) mobileOverlay.classList.add('open');
      document.body.style.overflow = 'hidden';
    }

    function closeMenu() {
      if (mobileMenu) mobileMenu.classList.remove('open');
      if (mobileOverlay) mobileOverlay.classList.remove('open');
      document.body.style.overflow = '';
    }

    if (mobileMenuBtn) mobileMenuBtn.addEventListener('click', openMenu);
    if (closeMenuBtn) closeMenuBtn.addEventListener('click', closeMenu);
    if (mobileOverlay) mobileOverlay.addEventListener('click', closeMenu);
    if (mobileMenu) mobileMenu.querySelectorAll('a').forEach(link => link.addEventListener('click', closeMenu));

    // Dark Mode Toggle
    const darkToggle = document.getElementById('dark-toggle');
    const mobileDarkToggle = document.getElementById('mobile-dark-toggle');
    const sunIcon = document.getElementById('sun-icon');
    const moonIcon = document.getElementById('moon-icon');
    const mobileSunIcon = document.getElementById('mobile-sun-icon');
    const mobileMoonIcon = document.getElementById('mobile-moon-icon');
    const darkModeText = document.getElementById('dark-mode-text');

    function updateDarkModeIcons() {
      const isDark = document.documentElement.classList.contains('dark');
      if (sunIcon) sunIcon.classList.toggle('hidden', !isDark);
      if (moonIcon) moonIcon.classList.toggle('hidden', isDark);
      if (mobileSunIcon) mobileSunIcon.classList.toggle('hidden', !isDark);
      if (mobileMoonIcon) mobileMoonIcon.classList.toggle('hidden', isDark);
      if (darkModeText) darkModeText.textContent = isDark ? 'Light Mode' : 'Dark Mode';
    }

    function toggleDarkMode() {
      document.documentElement.classList.toggle('dark');
      const isDark = document.documentElement.classList.contains('dark');
      // Use direct cookie setting to avoid dependency on SHARED_SCRIPTS loading order
      const expires = new Date(Date.now() + 365 * 864e5).toUTCString();
      document.cookie = 'darkMode=' + encodeURIComponent(isDark) + '; expires=' + expires + '; path=/; SameSite=Lax';
      updateDarkModeIcons();
    }

    if (darkToggle) darkToggle.addEventListener('click', toggleDarkMode);
    if (mobileDarkToggle) mobileDarkToggle.addEventListener('click', toggleDarkMode);
    updateDarkModeIcons();

    // Scroll Progress Bar
    const scrollProgress = document.getElementById('scroll-progress');
    window.addEventListener('scroll', () => {
      const scrollTop = window.scrollY;
      const docHeight = document.documentElement.scrollHeight - window.innerHeight;
      const scrollPercent = (scrollTop / docHeight) * 100;
      scrollProgress.style.width = scrollPercent + '%';
    });

    // Back to Top Button
    const backToTop = document.getElementById('back-to-top');
    window.addEventListener('scroll', () => {
      if (window.scrollY > 500) {
        backToTop.classList.add('visible');
      } else {
        backToTop.classList.remove('visible');
      }
    });
    backToTop.addEventListener('click', () => {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });

    // Scroll Reveal Animations
    const revealElements = document.querySelectorAll('.reveal, .reveal-left, .reveal-right, .reveal-scale');
    const revealObserver = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('active');
        }
      });
    }, { threshold: 0.1, rootMargin: '0px 0px -50px 0px' });

    revealElements.forEach(el => revealObserver.observe(el));
  </script>
<!-- MUSIC_PLAYER -->
<!-- Ambient Music Player -->
<div id="music-player" class="fixed bottom-8 left-8 z-[60] opacity-0 translate-y-4 transition-all duration-500">
  <!-- Expanded Player Panel -->
  <div id="music-panel" class="hidden mb-3 bg-navy-900/95 backdrop-blur-xl rounded-2xl shadow-2xl border border-white/10 overflow-hidden w-72">
    <!-- Track Visualizer Header -->
    <div class="relative h-24 bg-gradient-to-br from-gold-500/20 via-purple-500/20 to-blue-500/20 overflow-hidden">
      <div id="music-visualizer" class="absolute inset-0 flex items-end justify-center gap-1 px-4 pb-2"></div>
      <div class="absolute inset-0 bg-gradient-to-t from-navy-900/90 to-transparent"></div>
      <div class="absolute bottom-2 left-4 right-4">
        <p id="music-track-name" class="text-white font-semibold text-sm truncate">Select an atmosphere</p>
        <p id="music-track-artist" class="text-gray-400 text-xs truncate">Ambient Soundscape</p>
      </div>
    </div>

    <!-- Mood Selector -->
    <div class="p-4 border-b border-white/10">
      <label class="text-gray-400 text-xs block mb-2">Atmosphere</label>
      <select id="music-track-select" class="w-full bg-navy-800 text-white text-sm rounded-lg px-3 py-2.5 border border-white/10 focus:border-gold-500 focus:outline-none cursor-pointer">
        <option value="">Choose your vibe...</option>
        <optgroup label="Relaxing">
          <option value="dreamscape">Dreamscape</option>
          <option value="stardust">Stardust</option>
          <option value="rainfall">Gentle Rain</option>
        </optgroup>
        <optgroup label="Focus">
          <option value="deepwork">Deep Work</option>
          <option value="clarity">Mental Clarity</option>
          <option value="flow">Flow State</option>
        </optgroup>
        <optgroup label="Atmospheric">
          <option value="cosmos">Cosmic Journey</option>
          <option value="noir">Noir Atmosphere</option>
          <option value="sunrise">Golden Sunrise</option>
        </optgroup>
      </select>
    </div>

    <!-- Playback Controls -->
    <div class="p-4 flex items-center justify-center gap-4">
      <button id="music-play-btn" class="w-14 h-14 rounded-full bg-gold-500 hover:bg-gold-400 text-navy-900 flex items-center justify-center transition transform hover:scale-105 shadow-lg">
        <svg id="music-play-icon" class="w-6 h-6 ml-1" fill="currentColor" viewBox="0 0 24 24">
          <path d="M8 5v14l11-7z"></path>
        </svg>
        <svg id="music-pause-icon" class="w-6 h-6 hidden" fill="currentColor" viewBox="0 0 24 24">
          <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"></path>
        </svg>
      </button>
    </div>

    <!-- Volume Control -->
    <div class="px-4 pb-4">
      <div class="flex items-center gap-3">
        <button id="music-mute" class="text-gray-400 hover:text-white transition">
          <svg id="music-volume-icon" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072M18.364 5.636a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"></path>
          </svg>
          <svg id="music-mute-icon" class="w-5 h-5 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2"></path>
          </svg>
        </button>
        <div id="music-volume-container" class="flex-1 h-2 bg-navy-700 rounded-full cursor-pointer relative">
          <div id="music-volume-bar" class="h-full bg-gradient-to-r from-gold-500 to-gold-400 rounded-full transition-all" style="width: 70%"></div>
          <div id="music-volume-handle" class="absolute top-1/2 -translate-y-1/2 w-4 h-4 bg-white rounded-full shadow-lg cursor-grab" style="left: 70%"></div>
        </div>
        <span id="music-volume-value" class="text-gray-400 text-xs w-8">70%</span>
      </div>
    </div>

    <div class="px-4 pb-3 text-center">
      <p class="text-gray-500 text-xs">Generative ambient soundscapes</p>
    </div>
  </div>

  <!-- Floating Toggle Button -->
  <button id="music-toggle" class="relative bg-navy-900/90 hover:bg-navy-800 backdrop-blur-xl text-white p-4 rounded-full shadow-2xl border border-white/10 transition-all duration-300 hover:scale-110 hover:border-gold-500/50 group" style="pointer-events: auto !important; z-index: 9999 !important;">
    <div id="music-pulse" class="absolute inset-0 rounded-full border-2 border-gold-500/50 animate-ping hidden"></div>
    <svg id="music-note-icon" class="w-6 h-6 text-gold-400 group-hover:text-gold-300 transition" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"></path>
    </svg>
    <div id="music-eq-mini" class="absolute inset-0 flex items-center justify-center gap-0.5 hidden">
      <span class="w-1 h-3 bg-gold-400 rounded-full animate-eq-1"></span>
      <span class="w-1 h-4 bg-gold-400 rounded-full animate-eq-2"></span>
      <span class="w-1 h-2 bg-gold-400 rounded-full animate-eq-3"></span>
      <span class="w-1 h-3 bg-gold-400 rounded-full animate-eq-4"></span>
    </div>
    <span id="music-badge" class="absolute -top-1 -right-1 w-3 h-3 bg-gold-500 rounded-full hidden">
      <span class="absolute inset-0 rounded-full bg-gold-500 animate-ping"></span>
    </span>
  </button>

  <!-- Welcome notification -->
  <div id="music-welcome" class="absolute bottom-full left-0 mb-3 hidden opacity-0 transition-opacity duration-500 w-64">
    <div class="bg-navy-800/95 backdrop-blur-xl rounded-xl p-4 shadow-2xl border border-gold-500/20 relative">
      <div class="absolute -bottom-2 left-6 w-4 h-4 bg-navy-800/95 border-r border-b border-gold-500/20 transform rotate-45"></div>
      <div class="flex items-center gap-2 mb-2">
        <div class="w-8 h-8 rounded-full bg-gold-500/20 flex items-center justify-center">
          <svg class="w-4 h-4 text-gold-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"></path>
          </svg>
        </div>
        <span class="text-gold-400 font-semibold text-sm">Enhance Your Experience</span>
      </div>
      <p class="text-gray-300 text-xs leading-relaxed mb-3">
        Enable ambient soundscapes for an immersive browsing experience.
      </p>
      <div class="flex gap-2">
        <button id="music-welcome-play" class="flex-1 bg-gold-500 hover:bg-gold-400 text-navy-900 text-xs font-semibold py-2 px-3 rounded-lg transition transform hover:scale-105">
          Play Music
        </button>
        <button id="music-welcome-dismiss" class="px-3 py-2 text-gray-400 hover:text-white text-xs rounded-lg border border-white/10 hover:border-white/30 transition">
          Later
        </button>
      </div>
    </div>
  </div>
</div>

<style>
  #music-player.visible { opacity: 1; transform: translateY(0); }
  @keyframes eq-1 { 0%, 100% { height: 4px; } 50% { height: 16px; } }
  @keyframes eq-2 { 0%, 100% { height: 8px; } 50% { height: 20px; } }
  @keyframes eq-3 { 0%, 100% { height: 12px; } 50% { height: 8px; } }
  @keyframes eq-4 { 0%, 100% { height: 6px; } 50% { height: 14px; } }
  .animate-eq-1 { animation: eq-1 0.8s ease-in-out infinite; }
  .animate-eq-2 { animation: eq-2 0.6s ease-in-out infinite 0.1s; }
  .animate-eq-3 { animation: eq-3 0.7s ease-in-out infinite 0.2s; }
  .animate-eq-4 { animation: eq-4 0.5s ease-in-out infinite 0.15s; }
  .visualizer-bar { width: 4px; background: linear-gradient(to top, #f59e0b, #fbbf24); border-radius: 2px; transition: height 0.1s ease; }
  #music-track-select { appearance: none; background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%239ca3af'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E"); background-repeat: no-repeat; background-position: right 0.75rem center; background-size: 1rem; }
  #music-welcome.show { opacity: 1; }
  @keyframes welcome-glow { 0%, 100% { box-shadow: 0 0 20px rgba(245, 158, 11, 0.2); } 50% { box-shadow: 0 0 40px rgba(245, 158, 11, 0.4); } }
  #music-welcome.show > div { animation: welcome-glow 2s ease-in-out infinite; }
</style>

<script>
(function() {
  'use strict';

  const MUSIC_VERSION = '4';
  if (localStorage.getItem('musicVersion') !== MUSIC_VERSION) {
    localStorage.removeItem('musicTrack');
    localStorage.removeItem('musicEnabled');
    localStorage.removeItem('musicWelcomeSeen');
    localStorage.setItem('musicVersion', MUSIC_VERSION);
  }

  // Musical scales and chord progressions
  const SCALES = {
    major: [0, 2, 4, 5, 7, 9, 11],
    minor: [0, 2, 3, 5, 7, 8, 10],
    pentatonic: [0, 2, 4, 7, 9],
    dorian: [0, 2, 3, 5, 7, 9, 10]
  };

  // Rich ambient presets with musical parameters
  const MOODS = {
    'dreamscape': {
      name: 'Dreamscape',
      root: 220, // A3
      scale: 'pentatonic',
      chordType: 'seventh',
      tempo: 0.03,
      reverbMix: 0.7,
      filterFreq: 1200,
      layers: ['pad', 'shimmer', 'sub']
    },
    'stardust': {
      name: 'Stardust',
      root: 174.61, // F3
      scale: 'major',
      chordType: 'add9',
      tempo: 0.02,
      reverbMix: 0.8,
      filterFreq: 2000,
      layers: ['pad', 'bells', 'texture']
    },
    'rainfall': {
      name: 'Gentle Rain',
      root: 146.83, // D3
      scale: 'minor',
      chordType: 'sus4',
      tempo: 0.025,
      reverbMix: 0.6,
      filterFreq: 800,
      layers: ['rain', 'pad', 'sub']
    },
    'deepwork': {
      name: 'Deep Work',
      root: 110, // A2
      scale: 'dorian',
      chordType: 'power',
      tempo: 0.015,
      reverbMix: 0.5,
      filterFreq: 600,
      layers: ['drone', 'pulse', 'sub']
    },
    'clarity': {
      name: 'Mental Clarity',
      root: 196, // G3
      scale: 'pentatonic',
      chordType: 'triad',
      tempo: 0.04,
      reverbMix: 0.6,
      filterFreq: 1500,
      layers: ['binaural', 'pad', 'shimmer']
    },
    'flow': {
      name: 'Flow State',
      root: 164.81, // E3
      scale: 'major',
      chordType: 'seventh',
      tempo: 0.035,
      reverbMix: 0.55,
      filterFreq: 1000,
      layers: ['pad', 'arp', 'sub']
    },
    'cosmos': {
      name: 'Cosmic Journey',
      root: 82.41, // E2
      scale: 'minor',
      chordType: 'add9',
      tempo: 0.01,
      reverbMix: 0.85,
      filterFreq: 500,
      layers: ['drone', 'texture', 'sweep']
    },
    'noir': {
      name: 'Noir Atmosphere',
      root: 98, // G2
      scale: 'dorian',
      chordType: 'minor7',
      tempo: 0.02,
      reverbMix: 0.7,
      filterFreq: 400,
      layers: ['drone', 'dark', 'pulse']
    },
    'sunrise': {
      name: 'Golden Sunrise',
      root: 261.63, // C4
      scale: 'major',
      chordType: 'add9',
      tempo: 0.025,
      reverbMix: 0.65,
      filterFreq: 1800,
      layers: ['pad', 'shimmer', 'bells']
    }
  };

  const PAGE_MOOD_MAP = {
    'classical-peaceful': 'dreamscape',
    'classical-dramatic': 'cosmos',
    'classical-baroque': 'sunrise',
    'electronic-ambient': 'flow',
    'electronic-chill': 'stardust',
    'electronic-dark': 'noir',
    'acoustic-guitar': 'dreamscape',
    'acoustic-jazz': 'clarity',
    'cinematic-tension': 'noir',
    'cinematic-inspiring': 'cosmos'
  };

  let audioContext = null;
  let masterGain = null;
  let reverbNode = null;
  let nodes = [];
  let isPlaying = false;
  let currentMoodId = null;
  let volume = 0.7;
  let animationId = null;
  let analyser = null;

  const player = document.getElementById('music-player');
  if (!player) return;

  const panel = document.getElementById('music-panel');
  const toggleBtn = document.getElementById('music-toggle');
  const playBtn = document.getElementById('music-play-btn');
  const playIcon = document.getElementById('music-play-icon');
  const pauseIcon = document.getElementById('music-pause-icon');
  const trackSelect = document.getElementById('music-track-select');
  const trackName = document.getElementById('music-track-name');
  const trackArtist = document.getElementById('music-track-artist');
  const volumeBar = document.getElementById('music-volume-bar');
  const volumeHandle = document.getElementById('music-volume-handle');
  const volumeContainer = document.getElementById('music-volume-container');
  const volumeValue = document.getElementById('music-volume-value');
  const muteBtn = document.getElementById('music-mute');
  const volumeIcon = document.getElementById('music-volume-icon');
  const muteIcon = document.getElementById('music-mute-icon');
  const visualizer = document.getElementById('music-visualizer');
  const pulse = document.getElementById('music-pulse');
  const noteIcon = document.getElementById('music-note-icon');
  const eqMini = document.getElementById('music-eq-mini');
  const welcomeEl = document.getElementById('music-welcome');
  const welcomePlayBtn = document.getElementById('music-welcome-play');
  const welcomeDismissBtn = document.getElementById('music-welcome-dismiss');
  const musicBadge = document.getElementById('music-badge');

  function setMusicEnabled(enabled) { localStorage.setItem('musicEnabled', enabled ? 'true' : 'false'); }
  function isMusicEnabled() { return localStorage.getItem('musicEnabled') === 'true'; }

  function showWelcome() {
    if (localStorage.getItem('musicWelcomeSeen')) return;
    if (musicBadge) musicBadge.classList.remove('hidden');
    setTimeout(() => {
      if (welcomeEl && !isPlaying) {
        welcomeEl.classList.remove('hidden');
        setTimeout(() => welcomeEl.classList.add('show'), 50);
      }
    }, 3000);
  }

  function hideWelcome(permanent = false) {
    if (welcomeEl) {
      welcomeEl.classList.remove('show');
      setTimeout(() => welcomeEl.classList.add('hidden'), 500);
    }
    if (musicBadge) musicBadge.classList.add('hidden');
    if (permanent) localStorage.setItem('musicWelcomeSeen', 'true');
  }

  // Create convolution reverb
  function createReverb(duration = 3, decay = 2) {
    const sampleRate = audioContext.sampleRate;
    const length = sampleRate * duration;
    const impulse = audioContext.createBuffer(2, length, sampleRate);

    for (let channel = 0; channel < 2; channel++) {
      const channelData = impulse.getChannelData(channel);
      for (let i = 0; i < length; i++) {
        channelData[i] = (Math.random() * 2 - 1) * Math.pow(1 - i / length, decay);
      }
    }

    const convolver = audioContext.createConvolver();
    convolver.buffer = impulse;
    return convolver;
  }

  function initAudio() {
    if (audioContext) return;
    audioContext = new (window.AudioContext || window.webkitAudioContext)();

    masterGain = audioContext.createGain();
    masterGain.gain.value = volume;

    // Create reverb
    reverbNode = createReverb(4, 2.5);
    const reverbGain = audioContext.createGain();
    reverbGain.gain.value = 0.6;

    // Dry/wet mix
    const dryGain = audioContext.createGain();
    dryGain.gain.value = 0.4;

    masterGain.connect(dryGain);
    masterGain.connect(reverbNode);
    reverbNode.connect(reverbGain);
    dryGain.connect(audioContext.destination);
    reverbGain.connect(audioContext.destination);

    analyser = audioContext.createAnalyser();
    analyser.fftSize = 64;
    masterGain.connect(analyser);
  }

  function stopAllNodes() {
    nodes.forEach(node => {
      try {
        if (node.stop) node.stop();
        if (node.disconnect) node.disconnect();
      } catch (e) {}
    });
    nodes = [];
  }

  function noteToFreq(root, semitones) {
    return root * Math.pow(2, semitones / 12);
  }

  function getChordFreqs(root, scale, chordType) {
    const s = SCALES[scale];
    const freqs = [];

    switch(chordType) {
      case 'triad':
        freqs.push(root, noteToFreq(root, s[2]), noteToFreq(root, s[4]));
        break;
      case 'seventh':
        freqs.push(root, noteToFreq(root, s[2]), noteToFreq(root, s[4]), noteToFreq(root, s[6]));
        break;
      case 'add9':
        freqs.push(root, noteToFreq(root, s[2]), noteToFreq(root, s[4]), noteToFreq(root, s[1] + 12));
        break;
      case 'sus4':
        freqs.push(root, noteToFreq(root, s[3]), noteToFreq(root, s[4]));
        break;
      case 'power':
        freqs.push(root, noteToFreq(root, 7), root * 2);
        break;
      case 'minor7':
        freqs.push(root, noteToFreq(root, 3), noteToFreq(root, 7), noteToFreq(root, 10));
        break;
      default:
        freqs.push(root, noteToFreq(root, s[2]), noteToFreq(root, s[4]));
    }
    return freqs;
  }

  // Rich pad with multiple detuned oscillators
  function createPadLayer(mood) {
    const freqs = getChordFreqs(mood.root, mood.scale, mood.chordType);
    const filter = audioContext.createBiquadFilter();
    filter.type = 'lowpass';
    filter.frequency.value = mood.filterFreq;
    filter.Q.value = 0.7;

    freqs.forEach((freq, i) => {
      // Main oscillator
      const osc1 = audioContext.createOscillator();
      const osc2 = audioContext.createOscillator();
      const gain = audioContext.createGain();

      osc1.type = 'sine';
      osc2.type = 'triangle';
      osc1.frequency.value = freq;
      osc2.frequency.value = freq * 1.002; // Slight detune for richness

      gain.gain.value = 0.12 / freqs.length;

      osc1.connect(gain);
      osc2.connect(gain);
      gain.connect(filter);

      osc1.start();
      osc2.start();
      nodes.push(osc1, osc2);
    });

    // Slow filter modulation
    const lfo = audioContext.createOscillator();
    const lfoGain = audioContext.createGain();
    lfo.frequency.value = mood.tempo;
    lfoGain.gain.value = mood.filterFreq * 0.3;
    lfo.connect(lfoGain);
    lfoGain.connect(filter.frequency);
    lfo.start();
    nodes.push(lfo);

    filter.connect(masterGain);
  }

  // Shimmering high harmonics
  function createShimmerLayer(mood) {
    const freqs = getChordFreqs(mood.root * 2, mood.scale, 'triad');
    const filter = audioContext.createBiquadFilter();
    filter.type = 'bandpass';
    filter.frequency.value = 3000;
    filter.Q.value = 1;

    freqs.forEach(freq => {
      const osc = audioContext.createOscillator();
      const gain = audioContext.createGain();
      const tremolo = audioContext.createGain();
      const lfo = audioContext.createOscillator();

      osc.type = 'sine';
      osc.frequency.value = freq * 2;
      gain.gain.value = 0.03;

      lfo.frequency.value = 0.5 + Math.random() * 0.5;
      lfo.connect(tremolo.gain);
      tremolo.gain.value = 0.5;

      osc.connect(gain);
      gain.connect(tremolo);
      tremolo.connect(filter);

      osc.start();
      lfo.start();
      nodes.push(osc, lfo);
    });

    filter.connect(masterGain);
  }

  // Sub bass
  function createSubLayer(mood) {
    const osc = audioContext.createOscillator();
    const gain = audioContext.createGain();
    const filter = audioContext.createBiquadFilter();

    osc.type = 'sine';
    osc.frequency.value = mood.root / 2;
    gain.gain.value = 0.15;
    filter.type = 'lowpass';
    filter.frequency.value = 100;

    osc.connect(gain);
    gain.connect(filter);
    filter.connect(masterGain);

    osc.start();
    nodes.push(osc);
  }

  // Drone layer
  function createDroneLayer(mood) {
    const osc1 = audioContext.createOscillator();
    const osc2 = audioContext.createOscillator();
    const gain = audioContext.createGain();
    const filter = audioContext.createBiquadFilter();

    osc1.type = 'sawtooth';
    osc2.type = 'sawtooth';
    osc1.frequency.value = mood.root;
    osc2.frequency.value = mood.root * 1.005;

    gain.gain.value = 0.06;
    filter.type = 'lowpass';
    filter.frequency.value = mood.filterFreq * 0.5;
    filter.Q.value = 2;

    osc1.connect(gain);
    osc2.connect(gain);
    gain.connect(filter);
    filter.connect(masterGain);

    // Slow sweep
    const lfo = audioContext.createOscillator();
    const lfoGain = audioContext.createGain();
    lfo.frequency.value = 0.02;
    lfoGain.gain.value = mood.filterFreq * 0.3;
    lfo.connect(lfoGain);
    lfoGain.connect(filter.frequency);

    osc1.start();
    osc2.start();
    lfo.start();
    nodes.push(osc1, osc2, lfo);
  }

  // Rain/texture layer
  function createRainLayer() {
    const bufferSize = 2 * audioContext.sampleRate;
    const noiseBuffer = audioContext.createBuffer(2, bufferSize, audioContext.sampleRate);

    for (let channel = 0; channel < 2; channel++) {
      const data = noiseBuffer.getChannelData(channel);
      let lastOut = 0;
      for (let i = 0; i < bufferSize; i++) {
        const white = Math.random() * 2 - 1;
        data[i] = (lastOut + (0.02 * white)) / 1.02;
        lastOut = data[i];
        data[i] *= 3.5;
      }
    }

    const noise = audioContext.createBufferSource();
    noise.buffer = noiseBuffer;
    noise.loop = true;

    const filter = audioContext.createBiquadFilter();
    filter.type = 'bandpass';
    filter.frequency.value = 2000;
    filter.Q.value = 0.5;

    const gain = audioContext.createGain();
    gain.gain.value = 0.15;

    // Modulate for rain variation
    const lfo = audioContext.createOscillator();
    const lfoGain = audioContext.createGain();
    lfo.frequency.value = 0.1;
    lfoGain.gain.value = 0.05;
    lfo.connect(lfoGain);
    lfoGain.connect(gain.gain);

    noise.connect(filter);
    filter.connect(gain);
    gain.connect(masterGain);

    noise.start();
    lfo.start();
    nodes.push(noise, lfo);
  }

  // Texture layer
  function createTextureLayer() {
    const bufferSize = 4 * audioContext.sampleRate;
    const noiseBuffer = audioContext.createBuffer(2, bufferSize, audioContext.sampleRate);

    for (let channel = 0; channel < 2; channel++) {
      const data = noiseBuffer.getChannelData(channel);
      for (let i = 0; i < bufferSize; i++) {
        data[i] = Math.random() * 2 - 1;
      }
    }

    const noise = audioContext.createBufferSource();
    noise.buffer = noiseBuffer;
    noise.loop = true;

    const filter = audioContext.createBiquadFilter();
    filter.type = 'lowpass';
    filter.frequency.value = 300;

    const gain = audioContext.createGain();
    gain.gain.value = 0.04;

    noise.connect(filter);
    filter.connect(gain);
    gain.connect(masterGain);

    noise.start();
    nodes.push(noise);
  }

  // Binaural beats for focus
  function createBinauralLayer(mood) {
    const oscL = audioContext.createOscillator();
    const oscR = audioContext.createOscillator();
    const gainL = audioContext.createGain();
    const gainR = audioContext.createGain();
    const merger = audioContext.createChannelMerger(2);

    oscL.frequency.value = mood.root;
    oscR.frequency.value = mood.root + 10; // 10Hz alpha waves
    oscL.type = 'sine';
    oscR.type = 'sine';
    gainL.gain.value = 0.08;
    gainR.gain.value = 0.08;

    oscL.connect(gainL);
    oscR.connect(gainR);
    gainL.connect(merger, 0, 0);
    gainR.connect(merger, 0, 1);
    merger.connect(masterGain);

    oscL.start();
    oscR.start();
    nodes.push(oscL, oscR);
  }

  // Bells/chimes
  function createBellsLayer(mood) {
    const freqs = getChordFreqs(mood.root * 4, mood.scale, 'triad');

    function playBell() {
      if (!isPlaying) return;

      const freq = freqs[Math.floor(Math.random() * freqs.length)];
      const osc = audioContext.createOscillator();
      const gain = audioContext.createGain();

      osc.type = 'sine';
      osc.frequency.value = freq * (0.98 + Math.random() * 0.04);
      gain.gain.setValueAtTime(0.04, audioContext.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 4);

      osc.connect(gain);
      gain.connect(masterGain);

      osc.start();
      osc.stop(audioContext.currentTime + 4);

      setTimeout(playBell, 3000 + Math.random() * 5000);
    }

    setTimeout(playBell, 1000);
  }

  // Simple arpeggio
  function createArpLayer(mood) {
    const scale = SCALES[mood.scale];
    let noteIndex = 0;

    function playNote() {
      if (!isPlaying) return;

      const semitone = scale[noteIndex % scale.length];
      const octave = Math.floor(noteIndex / scale.length);
      const freq = noteToFreq(mood.root * 2, semitone + octave * 12);

      const osc = audioContext.createOscillator();
      const gain = audioContext.createGain();

      osc.type = 'triangle';
      osc.frequency.value = freq;
      gain.gain.setValueAtTime(0.05, audioContext.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 2);

      osc.connect(gain);
      gain.connect(masterGain);

      osc.start();
      osc.stop(audioContext.currentTime + 2);

      noteIndex = (noteIndex + 1) % (scale.length * 2);
      setTimeout(playNote, 2000 + Math.random() * 1000);
    }

    setTimeout(playNote, 2000);
  }

  // Pulse layer
  function createPulseLayer(mood) {
    const osc = audioContext.createOscillator();
    const gain = audioContext.createGain();
    const lfo = audioContext.createOscillator();
    const lfoGain = audioContext.createGain();

    osc.type = 'sine';
    osc.frequency.value = mood.root;
    gain.gain.value = 0.08;

    lfo.frequency.value = mood.tempo * 20;
    lfoGain.gain.value = 0.04;
    lfo.connect(lfoGain);
    lfoGain.connect(gain.gain);

    osc.connect(gain);
    gain.connect(masterGain);

    osc.start();
    lfo.start();
    nodes.push(osc, lfo);
  }

  // Dark atmosphere
  function createDarkLayer(mood) {
    const osc = audioContext.createOscillator();
    const gain = audioContext.createGain();
    const filter = audioContext.createBiquadFilter();

    osc.type = 'sawtooth';
    osc.frequency.value = mood.root / 2;
    gain.gain.value = 0.1;
    filter.type = 'lowpass';
    filter.frequency.value = 200;
    filter.Q.value = 8;

    const lfo = audioContext.createOscillator();
    const lfoGain = audioContext.createGain();
    lfo.frequency.value = 0.03;
    lfoGain.gain.value = 100;
    lfo.connect(lfoGain);
    lfoGain.connect(filter.frequency);

    osc.connect(gain);
    gain.connect(filter);
    filter.connect(masterGain);

    osc.start();
    lfo.start();
    nodes.push(osc, lfo);
  }

  // Filter sweep
  function createSweepLayer(mood) {
    const osc = audioContext.createOscillator();
    const gain = audioContext.createGain();
    const filter = audioContext.createBiquadFilter();

    osc.type = 'sawtooth';
    osc.frequency.value = mood.root;
    gain.gain.value = 0.04;
    filter.type = 'lowpass';
    filter.frequency.value = 100;
    filter.Q.value = 5;

    // Long sweep
    filter.frequency.setValueAtTime(100, audioContext.currentTime);
    filter.frequency.linearRampToValueAtTime(2000, audioContext.currentTime + 30);

    osc.connect(gain);
    gain.connect(filter);
    filter.connect(masterGain);

    osc.start();
    nodes.push(osc);
  }

  function loadMood(moodId) {
    if (!MOODS[moodId]) return;

    initAudio();
    stopAllNodes();

    if (audioContext.state === 'suspended') {
      audioContext.resume();
    }

    const mood = MOODS[moodId];
    currentMoodId = moodId;

    // Create layers based on mood config
    mood.layers.forEach(layer => {
      switch(layer) {
        case 'pad': createPadLayer(mood); break;
        case 'shimmer': createShimmerLayer(mood); break;
        case 'sub': createSubLayer(mood); break;
        case 'drone': createDroneLayer(mood); break;
        case 'rain': createRainLayer(); break;
        case 'texture': createTextureLayer(); break;
        case 'binaural': createBinauralLayer(mood); break;
        case 'bells': createBellsLayer(mood); break;
        case 'arp': createArpLayer(mood); break;
        case 'pulse': createPulseLayer(mood); break;
        case 'dark': createDarkLayer(mood); break;
        case 'sweep': createSweepLayer(mood); break;
      }
    });

    if (trackName) trackName.textContent = mood.name;
    if (trackArtist) trackArtist.textContent = 'Generative Ambient';
    if (trackSelect) trackSelect.value = moodId;
  }

  function play() {
    if (!currentMoodId && trackSelect && trackSelect.value) {
      loadMood(trackSelect.value);
    } else if (!currentMoodId) {
      loadMood('dreamscape');
    }

    if (audioContext && audioContext.state === 'suspended') {
      audioContext.resume();
    }

    isPlaying = true;
    setMusicEnabled(true);
    updatePlayButton();
    animateVisualizer();
    hideWelcome(true);
  }

  function pause() {
    stopAllNodes();
    isPlaying = false;
    currentMoodId = null;
    updatePlayButton();
    if (animationId) {
      cancelAnimationFrame(animationId);
      animationId = null;
    }
  }

  function togglePlay() {
    isPlaying ? pause() : play();
  }

  function updatePlayButton() {
    if (isPlaying) {
      if (playIcon) playIcon.classList.add('hidden');
      if (pauseIcon) pauseIcon.classList.remove('hidden');
      if (pulse) pulse.classList.remove('hidden');
      if (noteIcon) noteIcon.classList.add('hidden');
      if (eqMini) eqMini.classList.remove('hidden');
    } else {
      if (playIcon) playIcon.classList.remove('hidden');
      if (pauseIcon) pauseIcon.classList.add('hidden');
      if (pulse) pulse.classList.add('hidden');
      if (noteIcon) noteIcon.classList.remove('hidden');
      if (eqMini) eqMini.classList.add('hidden');
    }
  }

  function updateVolumeUI() {
    const percent = volume * 100;
    if (volumeBar) volumeBar.style.width = `${percent}%`;
    if (volumeHandle) volumeHandle.style.left = `${percent}%`;
    if (volumeValue) volumeValue.textContent = `${Math.round(percent)}%`;
    if (volume === 0) {
      if (volumeIcon) volumeIcon.classList.add('hidden');
      if (muteIcon) muteIcon.classList.remove('hidden');
    } else {
      if (volumeIcon) volumeIcon.classList.remove('hidden');
      if (muteIcon) muteIcon.classList.add('hidden');
    }
  }

  function createVisualizerBars() {
    if (!visualizer) return;
    visualizer.innerHTML = '';
    for (let i = 0; i < 32; i++) {
      const bar = document.createElement('div');
      bar.className = 'visualizer-bar';
      bar.style.height = '4px';
      visualizer.appendChild(bar);
    }
  }

  function animateVisualizer() {
    if (!isPlaying || !visualizer || !analyser) {
      if (animationId) cancelAnimationFrame(animationId);
      return;
    }
    const bars = visualizer.querySelectorAll('.visualizer-bar');
    const dataArray = new Uint8Array(analyser.frequencyBinCount);
    analyser.getByteFrequencyData(dataArray);
    bars.forEach((bar, i) => {
      const value = dataArray[i] || 0;
      bar.style.height = `${Math.max(4, (value / 255) * 60)}px`;
    });
    animationId = requestAnimationFrame(animateVisualizer);
  }

  function bindEvents() {
    if (toggleBtn && panel) {
      toggleBtn.addEventListener('click', () => {
        panel.classList.toggle('hidden');
        hideWelcome(true);
      });
    }
    if (welcomePlayBtn) {
      welcomePlayBtn.addEventListener('click', () => {
        hideWelcome(true);
        if (panel) panel.classList.remove('hidden');
        const pageMusicMeta = document.querySelector('meta[name="ambient:music"]');
        const pageTrack = pageMusicMeta ? pageMusicMeta.content : null;
        const moodId = PAGE_MOOD_MAP[pageTrack] || 'dreamscape';
        loadMood(moodId);
        play();
      });
    }
    if (welcomeDismissBtn) {
      welcomeDismissBtn.addEventListener('click', () => {
        hideWelcome(true);
        setMusicEnabled(false);
      });
    }
    if (playBtn) playBtn.addEventListener('click', togglePlay);
    if (trackSelect) {
      trackSelect.addEventListener('change', (e) => {
        if (e.target.value) {
          loadMood(e.target.value);
          play();
        }
      });
    }
    if (volumeContainer) {
      volumeContainer.addEventListener('click', (e) => {
        const rect = volumeContainer.getBoundingClientRect();
        volume = Math.max(0, Math.min(1, (e.clientX - rect.left) / rect.width));
        if (masterGain) masterGain.gain.value = volume;
        localStorage.setItem('musicVolume', volume);
        updateVolumeUI();
      });
    }
    if (muteBtn) {
      muteBtn.addEventListener('click', () => {
        volume = volume === 0 ? 0.7 : 0;
        if (masterGain) masterGain.gain.value = volume;
        updateVolumeUI();
      });
    }
  }

  function init() {
    const pageMusicMeta = document.querySelector('meta[name="ambient:music"]');
    const pageTrack = pageMusicMeta ? pageMusicMeta.content : null;
    const pageMood = PAGE_MOOD_MAP[pageTrack] || 'dreamscape';

    const savedVolume = localStorage.getItem('musicVolume');
    if (savedVolume) {
      volume = parseFloat(savedVolume);
      updateVolumeUI();
    }

    if (trackSelect) trackSelect.value = pageMood;
    createVisualizerBars();

    const musicWasEnabled = isMusicEnabled();

    setTimeout(() => {
      player.classList.add('visible');
      if (musicWasEnabled) {
        loadMood(pageMood);
        play();
      } else {
        showWelcome();
      }
    }, 1000);

    bindEvents();
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', init);
  } else {
    init();
  }
})();
</script>

<!-- /MUSIC_PLAYER -->

<!-- COOKIE_CONSENT -->
<!-- Cookie Consent Banner -->
<div id="cookie-consent" class="fixed bottom-0 left-0 right-0 z-[100] transform translate-y-full transition-transform duration-500" role="dialog" aria-labelledby="cookie-consent-title" aria-describedby="cookie-consent-description">
  <div class="bg-navy-900/98 backdrop-blur-lg border-t border-white/10 shadow-2xl">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
      <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4">
        <div class="flex-1">
          <h3 id="cookie-consent-title" class="text-white font-semibold text-lg mb-2">We value your privacy</h3>
          <p id="cookie-consent-description" class="text-gray-400 text-sm leading-relaxed">
            We use cookies to enhance your browsing experience, analyze site traffic, and personalize content.
            By clicking "Accept All", you consent to our use of cookies. You can manage your preferences anytime.
          </p>
        </div>
        <div class="flex flex-col sm:flex-row gap-3 lg:ml-8">
          <button id="cookie-customize" class="px-5 py-2.5 text-gray-300 hover:text-white border border-white/20 hover:border-white/40 rounded-full text-sm font-medium transition">
            Customize
          </button>
          <button id="cookie-reject" class="px-5 py-2.5 text-gray-300 hover:text-white border border-white/20 hover:border-white/40 rounded-full text-sm font-medium transition">
            Reject All
          </button>
          <button id="cookie-accept" class="px-6 py-2.5 bg-gold-500 hover:bg-gold-400 text-navy-900 rounded-full text-sm font-semibold transition transform hover:scale-105">
            Accept All
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Cookie Settings Modal -->
<div id="cookie-modal" class="fixed inset-0 z-[110] hidden" role="dialog" aria-modal="true" aria-labelledby="cookie-modal-title">
  <div class="fixed inset-0 bg-black/60 backdrop-blur-sm" id="cookie-modal-backdrop"></div>
  <div class="fixed inset-0 overflow-y-auto">
    <div class="flex min-h-full items-center justify-center p-4">
      <div class="bg-navy-800 rounded-2xl shadow-2xl max-w-lg w-full border border-white/10 transform transition-all">
        <div class="p-6 border-b border-white/10">
          <div class="flex items-center justify-between">
            <h3 id="cookie-modal-title" class="text-xl font-bold text-white">Cookie Preferences</h3>
            <button id="cookie-modal-close" class="text-gray-400 hover:text-white transition" aria-label="Close modal">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
              </svg>
            </button>
          </div>
          <p class="text-gray-400 text-sm mt-2">Manage your cookie preferences below. Essential cookies are always active as they're necessary for the site to function.</p>
        </div>

        <div class="p-6 space-y-4">
          <!-- Essential Cookies -->
          <div class="flex items-start justify-between p-4 bg-white/5 rounded-xl">
            <div class="flex-1 pr-4">
              <h4 class="text-white font-semibold">Essential Cookies</h4>
              <p class="text-gray-400 text-sm mt-1">Required for basic site functionality like navigation and secure access. Cannot be disabled.</p>
            </div>
            <div class="relative">
              <input type="checkbox" id="cookie-essential" checked disabled class="sr-only">
              <div class="w-11 h-6 bg-gold-500 rounded-full opacity-50 cursor-not-allowed">
                <div class="absolute top-0.5 left-5 w-5 h-5 bg-white rounded-full shadow"></div>
              </div>
            </div>
          </div>

          <!-- Analytics Cookies -->
          <div class="flex items-start justify-between p-4 bg-white/5 rounded-xl">
            <div class="flex-1 pr-4">
              <label for="cookie-analytics" class="text-white font-semibold cursor-pointer">Analytics Cookies</label>
              <p class="text-gray-400 text-sm mt-1">Help us understand how visitors interact with our site. We use Google Analytics and Microsoft Clarity.</p>
            </div>
            <label for="cookie-analytics" class="relative cursor-pointer">
              <input type="checkbox" id="cookie-analytics" class="sr-only peer">
              <div class="w-11 h-6 bg-gray-600 peer-checked:bg-gold-500 rounded-full transition-colors"></div>
              <div class="absolute top-0.5 left-0.5 peer-checked:left-5 w-5 h-5 bg-white rounded-full shadow transition-all"></div>
            </label>
          </div>

          <!-- Marketing Cookies -->
          <div class="flex items-start justify-between p-4 bg-white/5 rounded-xl">
            <div class="flex-1 pr-4">
              <label for="cookie-marketing" class="text-white font-semibold cursor-pointer">Marketing Cookies</label>
              <p class="text-gray-400 text-sm mt-1">Used to track visitors across websites to display relevant ads and measure campaign effectiveness.</p>
            </div>
            <label for="cookie-marketing" class="relative cursor-pointer">
              <input type="checkbox" id="cookie-marketing" class="sr-only peer">
              <div class="w-11 h-6 bg-gray-600 peer-checked:bg-gold-500 rounded-full transition-colors"></div>
              <div class="absolute top-0.5 left-0.5 peer-checked:left-5 w-5 h-5 bg-white rounded-full shadow transition-all"></div>
            </label>
          </div>
        </div>

        <div class="p-6 border-t border-white/10 flex justify-end gap-3">
          <button id="cookie-modal-reject" class="px-5 py-2.5 text-gray-300 hover:text-white border border-white/20 hover:border-white/40 rounded-full text-sm font-medium transition">
            Reject All
          </button>
          <button id="cookie-modal-save" class="px-6 py-2.5 bg-gold-500 hover:bg-gold-400 text-navy-900 rounded-full text-sm font-semibold transition">
            Save Preferences
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- /COOKIE_CONSENT -->

<!-- SHARED_SCRIPTS -->
<script>
// ===== COOKIE UTILITIES =====
function getCookie(name) {
  const match = document.cookie.match(new RegExp('(^| )' + name + '=([^;]+)'));
  return match ? match[2] : null;
}

function setCookie(name, value, days) {
  const expires = new Date(Date.now() + days * 864e5).toUTCString();
  document.cookie = name + '=' + encodeURIComponent(value) + '; expires=' + expires + '; path=/; SameSite=Lax';
}

function deleteCookie(name) {
  document.cookie = name + '=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';
}

// ===== COOKIE CONSENT MANAGEMENT =====
const CookieConsent = {
  CONSENT_COOKIE: 'cookieConsent',
  CONSENT_VERSION: '1.0',

  getConsent() {
    const consent = getCookie(this.CONSENT_COOKIE);
    if (!consent) return null;
    try {
      return JSON.parse(decodeURIComponent(consent));
    } catch (e) {
      return null;
    }
  },

  setConsent(preferences) {
    const consent = {
      version: this.CONSENT_VERSION,
      timestamp: new Date().toISOString(),
      essential: true, // Always true
      analytics: preferences.analytics || false,
      marketing: preferences.marketing || false
    };
    setCookie(this.CONSENT_COOKIE, JSON.stringify(consent), 365);
    return consent;
  },

  hasConsent() {
    return this.getConsent() !== null;
  },

  hasAnalyticsConsent() {
    const consent = this.getConsent();
    return consent && consent.analytics === true;
  },

  hasMarketingConsent() {
    const consent = this.getConsent();
    return consent && consent.marketing === true;
  },

  showBanner() {
    const banner = document.getElementById('cookie-consent');
    if (banner) {
      banner.classList.remove('translate-y-full');
    }
  },

  hideBanner() {
    const banner = document.getElementById('cookie-consent');
    if (banner) {
      banner.classList.add('translate-y-full');
    }
  },

  showModal() {
    const modal = document.getElementById('cookie-modal');
    if (modal) {
      modal.classList.remove('hidden');
      document.body.style.overflow = 'hidden';
      // Set checkboxes to current preferences
      const consent = this.getConsent() || { analytics: false, marketing: false };
      const analyticsCheckbox = document.getElementById('cookie-analytics');
      const marketingCheckbox = document.getElementById('cookie-marketing');
      if (analyticsCheckbox) analyticsCheckbox.checked = consent.analytics;
      if (marketingCheckbox) marketingCheckbox.checked = consent.marketing;
    }
  },

  hideModal() {
    const modal = document.getElementById('cookie-modal');
    if (modal) {
      modal.classList.add('hidden');
      document.body.style.overflow = '';
    }
  },

  acceptAll() {
    const consent = this.setConsent({ analytics: true, marketing: true });
    this.hideBanner();
    this.hideModal();
    this.applyConsent(consent);
    if (typeof siteAnalytics !== 'undefined') {
      siteAnalytics.trackEvent('cookie_consent', { consent_type: 'accept_all' });
    }
  },

  rejectAll() {
    const consent = this.setConsent({ analytics: false, marketing: false });
    this.hideBanner();
    this.hideModal();
    this.applyConsent(consent);
  },

  savePreferences() {
    const analyticsCheckbox = document.getElementById('cookie-analytics');
    const marketingCheckbox = document.getElementById('cookie-marketing');
    const consent = this.setConsent({
      analytics: analyticsCheckbox ? analyticsCheckbox.checked : false,
      marketing: marketingCheckbox ? marketingCheckbox.checked : false
    });
    this.hideBanner();
    this.hideModal();
    this.applyConsent(consent);
    if (consent.analytics && typeof siteAnalytics !== 'undefined') {
      siteAnalytics.trackEvent('cookie_consent', { consent_type: 'custom', analytics: consent.analytics, marketing: consent.marketing });
    }
  },

  applyConsent(consent) {
    // Dispatch event for analytics.js to listen to
    window.dispatchEvent(new CustomEvent('cookieConsentUpdated', { detail: consent }));
  },

  init() {
    if (!this.hasConsent()) {
      // Show banner after a short delay for better UX
      setTimeout(() => this.showBanner(), 1000);
    } else {
      // Apply existing consent
      this.applyConsent(this.getConsent());
    }
  }
};

// ===== MOBILE MENU =====
function initMobileMenu() {
  const mobileMenuBtn = document.getElementById('mobile-menu-btn');
  const closeMenuBtn = document.getElementById('close-menu');
  const mobileMenu = document.getElementById('mobile-menu');
  const menuOverlay = document.getElementById('menu-overlay');

  if (!mobileMenuBtn || !mobileMenu) return;

  function openMobileMenu() {
    mobileMenu.classList.add('open');
    if (menuOverlay) menuOverlay.classList.add('open');
    document.body.style.overflow = 'hidden';
  }

  function closeMobileMenu() {
    mobileMenu.classList.remove('open');
    if (menuOverlay) menuOverlay.classList.remove('open');
    document.body.style.overflow = '';
  }

  mobileMenuBtn.addEventListener('click', openMobileMenu);
  if (closeMenuBtn) closeMenuBtn.addEventListener('click', closeMobileMenu);
  if (menuOverlay) menuOverlay.addEventListener('click', closeMobileMenu);

  // Close menu when clicking a link
  mobileMenu.querySelectorAll('a').forEach(link => {
    link.addEventListener('click', closeMobileMenu);
  });

  // Close on Escape key
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && mobileMenu.classList.contains('open')) {
      closeMobileMenu();
    }
  });
}

// ===== DARK MODE TOGGLE =====
function initDarkMode() {
  const darkModeToggle = document.getElementById('dark-mode-toggle');
  const darkModeToggleMobile = document.getElementById('dark-mode-toggle-mobile');

  // Prevent duplicate initialization
  if (window._darkModeInitialized) return;
  window._darkModeInitialized = true;

  function toggleDarkMode() {
    document.documentElement.classList.toggle('dark');
    const isDark = document.documentElement.classList.contains('dark');
    setCookie('darkMode', isDark, 365);
  }

  if (darkModeToggle) darkModeToggle.addEventListener('click', toggleDarkMode);
  if (darkModeToggleMobile) darkModeToggleMobile.addEventListener('click', toggleDarkMode);
}

// ===== BACK TO TOP =====
function initBackToTop() {
  const backToTop = document.getElementById('back-to-top');
  if (!backToTop) return;

  function updateBackToTop() {
    if (window.scrollY > 500) {
      backToTop.classList.add('visible');
    } else {
      backToTop.classList.remove('visible');
    }
  }

  backToTop.addEventListener('click', () => {
    window.scrollTo({ top: 0, behavior: 'smooth' });
  });

  window.addEventListener('scroll', updateBackToTop);
}

// ===== SCROLL REVEAL =====
function initScrollReveal() {
  const revealObserver = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add('visible');
      }
    });
  }, { threshold: 0.1, rootMargin: '0px 0px -50px 0px' });

  document.querySelectorAll('.reveal, .card-hover, .stagger-children').forEach(el => {
    revealObserver.observe(el);
  });
}

// ===== SMOOTH SCROLL =====
function initSmoothScroll() {
  document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function(e) {
      const href = this.getAttribute('href');
      if (href !== '#') {
        e.preventDefault();
        const target = document.querySelector(href);
        if (target) {
          const headerOffset = 80;
          const elementPosition = target.getBoundingClientRect().top;
          const offsetPosition = elementPosition + window.scrollY - headerOffset;

          window.scrollTo({
            top: offsetPosition,
            behavior: 'smooth'
          });
        }
      }
    });
  });
}

// ===== COOKIE CONSENT EVENT LISTENERS =====
function initCookieConsentListeners() {
  // Banner buttons
  const acceptBtn = document.getElementById('cookie-accept');
  const rejectBtn = document.getElementById('cookie-reject');
  const customizeBtn = document.getElementById('cookie-customize');

  if (acceptBtn) acceptBtn.addEventListener('click', () => CookieConsent.acceptAll());
  if (rejectBtn) rejectBtn.addEventListener('click', () => CookieConsent.rejectAll());
  if (customizeBtn) customizeBtn.addEventListener('click', () => {
    CookieConsent.hideBanner();
    CookieConsent.showModal();
  });

  // Modal buttons
  const modalClose = document.getElementById('cookie-modal-close');
  const modalBackdrop = document.getElementById('cookie-modal-backdrop');
  const modalReject = document.getElementById('cookie-modal-reject');
  const modalSave = document.getElementById('cookie-modal-save');

  if (modalClose) modalClose.addEventListener('click', () => CookieConsent.hideModal());
  if (modalBackdrop) modalBackdrop.addEventListener('click', () => CookieConsent.hideModal());
  if (modalReject) modalReject.addEventListener('click', () => CookieConsent.rejectAll());
  if (modalSave) modalSave.addEventListener('click', () => CookieConsent.savePreferences());

  // Footer cookie settings button
  const cookieSettingsBtn = document.getElementById('cookie-settings-btn');
  if (cookieSettingsBtn) cookieSettingsBtn.addEventListener('click', () => CookieConsent.showModal());

  // Note: Cookie toggles are now wrapped in <label> elements, so native browser behavior handles the toggle.
  // No additional JavaScript handlers needed for the toggle switches.
}

// ===== INITIALIZE ALL =====
function initAll() {
  initMobileMenu();
  initDarkMode();
  initBackToTop();
  initScrollReveal();
  initSmoothScroll();
  initCookieConsentListeners();
  CookieConsent.init();
}

// Handle both fresh page load and cases where DOM is already ready
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', initAll);
} else {
  // DOM is already ready, initialize immediately
  initAll();
}

// Expose CookieConsent for external use
window.CookieConsent = CookieConsent;
</script>

<!-- /SHARED_SCRIPTS -->
</body>
</html>
