<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>"It Must Be Nice to Have Time to Work Out" — The Worst Excuse in Productivity | Lee Foropoulos</title>
  <meta name="description" content="The 'I don't have time to exercise' excuse is backwards. Exercise IS your most productive time. Here's why movement unlocks mental performance.">
  <meta name="ambient:music" content="flow-state">
  <meta property="og:type" content="article">
  <meta property="og:title" content="It Must Be Nice to Have Time to Work Out — The Worst Excuse in Productivity">
  <meta property="og:description" content="The 'I don't have time to exercise' excuse is backwards. Exercise IS your most productive time. Here's how to reframe fitness as a productivity multiplier.">
  <meta property="og:url" content="https://foropoulosnow.com/blog/posts/must-be-nice-to-have-time-to-workout.html">
  <meta property="og:image" content="https://res.cloudinary.com/foropoulosnow/image/fetch/w_1200,h_630,c_fill,q_auto,f_auto/https%3A%2F%2Fimages.unsplash.com%2Fphoto-1534438327276-14e5300c3a48">
  <meta property="article:author" content="Lee Foropoulos">
  <meta property="article:published_time" content="2026-01-24">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="It Must Be Nice to Have Time to Work Out">
  <meta name="twitter:description" content="The 'I don't have time' excuse is backwards. Exercise IS your most productive time.">
  <meta name="share:hook" content="'Must be nice to have time to work out.' I hear this constantly. Here's why it's the most backwards excuse in productivity:">
  <meta name="twitter:image" content="https://res.cloudinary.com/foropoulosnow/image/fetch/w_1200,h_630,c_fill,q_auto,f_auto/https%3A%2F%2Fimages.unsplash.com%2Fphoto-1534438327276-14e5300c3a48">
  <meta name="facebook-domain-verification" content="vx40czm6ccxtpl4crzqbiso70hmjoi" />

  <link rel="icon" type="image/svg+xml" href="../../favicon.svg">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            navy: { 900: '#0f172a', 800: '#1e293b', 700: '#334155' },
            gold: { 600: '#d97706', 500: '#f59e0b', 400: '#fbbf24' }
          }
        }
      }
    }
  </script>
  <!-- Dark mode initialization (prevents flash) -->
  <script>
    (function() {
      function getCookie(name) {
        const match = document.cookie.match(new RegExp('(^| )' + name + '=([^;]+)'));
        return match ? match[2] : null;
      }
      const darkPref = getCookie('darkMode');
      if (darkPref === 'true' || (!darkPref && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
        document.documentElement.classList.add('dark');
      }
    })();
  </script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', system-ui, sans-serif; }
    .prose h2 { margin-top: 2.5rem; margin-bottom: 1rem; }
    .prose p { margin-bottom: 1.25rem; line-height: 1.8; }
    .prose ul, .prose ol { margin-bottom: 1.5rem; }
    .prose li { margin-bottom: 0.5rem; line-height: 1.7; }
    .prose blockquote { border-left: 4px solid #f59e0b; padding-left: 1.5rem; margin: 2rem 0; font-style: italic; }
    #back-to-top { opacity: 0; visibility: hidden; transition: all 0.3s ease; }
    #back-to-top.visible { opacity: 1; visibility: visible; }
    .content-image { border-radius: 0.75rem; margin: 2rem 0; box-shadow: 0 10px 40px rgba(0,0,0,0.15); }
    .share-btn { position: relative; display: inline-flex; align-items: center; justify-content: center; width: 2.75rem; height: 2.75rem; border-radius: 50%; transition: all 0.2s ease; }
    .share-btn:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
    .share-btn svg { width: 1.25rem; height: 1.25rem; }
    .share-btn[data-tooltip]:hover::after { content: attr(data-tooltip); position: absolute; bottom: -2rem; left: 50%; transform: translateX(-50%); background: #0f172a; color: white; padding: 0.25rem 0.5rem; border-radius: 0.25rem; font-size: 0.75rem; white-space: nowrap; z-index: 10; }
    .dark .share-btn[data-tooltip]:hover::after { background: #f59e0b; color: #0f172a; }
    .copy-toast { position: fixed; bottom: 2rem; left: 50%; transform: translateX(-50%) translateY(100px); background: #0f172a; color: white; padding: 0.75rem 1.5rem; border-radius: 0.5rem; font-weight: 500; opacity: 0; transition: all 0.3s ease; z-index: 100; }
    .copy-toast.show { transform: translateX(-50%) translateY(0); opacity: 1; }
  </style>
  <!-- Analytics: Google Analytics 4 + Microsoft Clarity -->
  <script src="/analytics.js" defer></script>
</head>
<body class="bg-white dark:bg-navy-900 text-gray-800 dark:text-gray-200">

  <!-- Navigation -->
  <nav class="fixed top-0 left-0 right-0 z-50 bg-navy-900/95 backdrop-blur-md border-b border-white/10">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center h-16">
        <a href="../" class="text-white font-bold text-xl">Foropoulos<span class="text-gold-400">Now</span></a>
        <div class="flex items-center gap-4">
          <a href="../" class="text-gray-300 hover:text-gold-400 transition text-sm">Blog</a>
          <button id="dark-mode-toggle" class="text-gray-300 hover:text-gold-400 p-2" aria-label="Toggle dark mode">
            <svg class="w-5 h-5 hidden dark:block" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
            </svg>
            <svg class="w-5 h-5 block dark:hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
            </svg>
          </button>
        </div>
      </div>
    </div>
  </nav>

  <!-- Hero Section -->
  <header class="pt-24 pb-12 bg-gradient-to-br from-navy-900 via-navy-800 to-navy-900">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
      <a href="../" class="inline-flex items-center text-gold-400 hover:text-gold-300 mb-6 transition">
        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
        Back to Blog
      </a>
      <div class="flex items-center gap-3 mb-4">
        <span class="bg-amber-500/20 text-amber-400 text-xs font-semibold px-3 py-1 rounded-full">Mindset</span>
        <span class="bg-green-500/20 text-green-400 text-xs font-semibold px-3 py-1 rounded-full">Fitness</span>
        <span class="text-gray-400 text-sm">Jan 24, 2026</span>
        <span class="text-gray-500 text-sm">8 min read</span>
      </div>
      <h1 class="text-3xl sm:text-4xl lg:text-5xl font-bold text-white mb-6 leading-tight">
        "It Must Be Nice to Have Time to Work Out"
      </h1>
      <p class="text-xl text-gray-300 leading-relaxed">
        This is my favorite thing I hear from people. It's also the most backwards excuse in productivity. Here's why exercise isn't taking time from your day — it's multiplying it.
      </p>
      <!-- Quick Share Buttons -->
      <div class="flex items-center gap-2 mt-6">
        <span class="text-gray-400 text-sm mr-1">Share:</span>
        <button onclick="shareOnTwitter()" class="w-8 h-8 rounded-full bg-white/10 hover:bg-white/20 text-white flex items-center justify-center transition" aria-label="Share on X">
          <svg class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
        </button>
        <button onclick="shareOnLinkedIn()" class="w-8 h-8 rounded-full bg-white/10 hover:bg-white/20 text-white flex items-center justify-center transition" aria-label="Share on LinkedIn">
          <svg class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
        </button>
        <button onclick="shareOnFacebook()" class="w-8 h-8 rounded-full bg-white/10 hover:bg-white/20 text-white flex items-center justify-center transition" aria-label="Share on Facebook">
          <svg class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>
        </button>
        <button onclick="copyLink()" class="w-8 h-8 rounded-full bg-white/10 hover:bg-white/20 text-white flex items-center justify-center transition" aria-label="Copy Link">
          <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg>
        </button>
      </div>
    </div>
  </header>

  <!-- Featured Image -->
  <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 -mt-6">
    <img src="https://images.unsplash.com/photo-1534438327276-14e5300c3a48?w=1200&h=600&fit=crop" alt="Person exercising in gym" class="w-full h-64 sm:h-80 object-cover rounded-2xl shadow-2xl">
  </div>

  <!-- Article Content -->
  <article class="py-12">
    <div class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="prose dark:prose-invert max-w-none">

        <p class="text-lg text-gray-600 dark:text-gray-300 leading-relaxed">
          "Must be nice to have the time to work out."
        </p>

        <p>
          I hear this constantly. At networking events. From colleagues. From friends who watch me leave for a morning walk or head to the gym for a 45-minute session. They say it with a mixture of admiration and resentment, as if I've somehow been gifted extra hours in my day that they weren't.
        </p>

        <p>
          Here's the thing: they're looking at this completely backwards.
        </p>

        <p>
          People act like 45 minutes of training is some blockbuster marathon that devours their entire day. A one-hour walk in the morning and another in the evening? An extravagant disruption to their "valuable" time. The underlying assumption is that exercise <em>takes away</em> from the time you could spend being productive.
        </p>

        <p>
          <strong>That assumption is idiotic.</strong> And I say that with love, because I used to think the same way.
        </p>

        <h2 class="text-2xl font-bold text-navy-900 dark:text-white">Exercise Is Not a Time Cost — It's a Time Multiplier</h2>

        <p>
          The reality is that the time I spend in the gym or on a walk is my <em>thinking time</em>. It's when I do my best work — just not the kind that looks like work to outside observers.
        </p>

        <p>
          During my morning walks and training sessions, I'm:
        </p>

        <ul class="space-y-2">
          <li><strong>Planning my product backlog</strong> — prioritizing features, thinking through user stories, mapping dependencies</li>
          <li><strong>Working through my toughest problems</strong> — the ones that don't yield to brute-force desk time</li>
          <li><strong>Listening to audiobooks</strong> — absorbing new skills, management principles, and strategic frameworks</li>
          <li><strong>Processing information</strong> — letting my subconscious work on challenges while my body moves</li>
        </ul>

        <p>
          This isn't accidental. It's neuroscience. In my review of <a href="book-review-brain-rules" class="text-gold-600 dark:text-gold-400 hover:underline">Brain Rules by John Medina</a>, I covered Rule #1: <strong>Exercise Boosts Brain Power</strong>. The research is unambiguous — physical movement increases blood flow to the brain, stimulates the release of BDNF (brain-derived neurotrophic factor), and enhances cognitive function across every measurable dimension.
        </p>

        <blockquote>
          "Exercise is the single most powerful tool we have to optimize brain function."
          <cite class="block mt-2 text-sm not-italic text-gray-500">— John Medina, Brain Rules</cite>
        </blockquote>

        <p>
          When you exercise, you're not stealing time from productivity. You're <em>investing</em> in the cognitive capacity that makes real productivity possible.
        </p>

        <h2 class="text-2xl font-bold text-navy-900 dark:text-white">The Problem Isn't Time — It's Mindset</h2>

        <p>
          People who say they don't have time to exercise are revealing something about how they think, not how busy they actually are. They view exercise as a separate activity — something that competes with work, family, and other responsibilities.
        </p>

        <p>
          But here's the truth: <strong>a body in motion is primed for productive tasks that a sedentary body simply cannot perform.</strong>
        </p>

        <p>
          When I sit at a desk for eight hours straight, I'm operating at maybe 60% of my cognitive capacity by hour six. My focus wanders. My creativity flatlines. I make worse decisions. I'm slower at everything.
        </p>

        <p>
          When I break that day with movement — a morning walk, a midday training session — I return to my desk <em>sharper</em>. The "lost" 45 minutes gets repaid tenfold in the quality and speed of my subsequent work.
        </p>

        <p>
          The excuse of "no time" is a bad one. It's a framing problem. You're not giving up time to exercise. You're giving up suboptimal hours for optimized ones.
        </p>

        <h2 class="text-2xl font-bold text-navy-900 dark:text-white">Stacking Habits: How to Make Exercise Automatic</h2>

        <p>
          If you're still struggling to find time for fitness, the issue isn't your schedule — it's that you haven't built the right systems. I wrote extensively about this in my post on <a href="habit-stacking-workouts" class="text-gold-600 dark:text-gold-400 hover:underline">habit stacking for workouts</a>.
        </p>

        <p>
          The core principle is simple: don't treat exercise as a standalone event that requires motivation and willpower. Instead, attach it to habits you already have.
        </p>

        <ul class="space-y-2">
          <li><strong>After I pour my morning coffee</strong> → I put on my walking shoes and head out the door</li>
          <li><strong>After I drop my kids at school</strong> → I drive directly to the gym (gym bag already in the car)</li>
          <li><strong>After my last meeting of the day</strong> → I take a 30-minute walk to decompress</li>
        </ul>

        <p>
          When you stack habits correctly, exercise stops being something you have to "find time" for. It becomes automatic — as thoughtless as brushing your teeth.
        </p>

        <p>
          The right habits replace the excuse. And once you've built the system, you'll wonder how you ever thought you didn't have time.
        </p>

        <h2 class="text-2xl font-bold text-navy-900 dark:text-white">Making Every Minute Count: The Plaud Note Pro</h2>

        <p>
          Here's where I take my exercise productivity to another level.
        </p>

        <p>
          I use a <a href="https://plaudus.sjv.io/thesecretchief" target="_blank" rel="noopener" class="text-gold-600 dark:text-gold-400 hover:underline">Plaud Note Pro</a> — an AI-powered voice recorder that has become one of my most valuable productivity tools. During walks and training sessions, ideas come fast. Problems get solved. Insights emerge. Without a way to capture them, they evaporate.
        </p>

        <div class="bg-gradient-to-br from-gray-50 to-gray-100 dark:from-navy-800 dark:to-navy-700 rounded-2xl p-6 my-8 border border-gray-200 dark:border-navy-600">
          <div class="flex items-start gap-4">
            <div class="w-12 h-12 bg-gold-500/20 rounded-xl flex items-center justify-center flex-shrink-0">
              <svg class="w-6 h-6 text-gold-600 dark:text-gold-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"></path>
              </svg>
            </div>
            <div>
              <h3 class="font-bold text-navy-900 dark:text-white mb-2">Plaud Note Pro</h3>
              <p class="text-gray-600 dark:text-gray-300 text-sm mb-3">
                The Plaud Note Pro is an ultra-thin AI voice recorder that captures audio with exceptional clarity and uses AI to transcribe, summarize, and organize your thoughts. It attaches magnetically to your phone or clips to your clothing, making it perfect for capturing ideas during movement.
              </p>
              <a href="https://plaudus.sjv.io/thesecretchief" target="_blank" rel="noopener" class="inline-flex items-center text-gold-600 dark:text-gold-400 hover:underline text-sm font-medium">
                Learn more about Plaud Note Pro
                <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path></svg>
              </a>
            </div>
          </div>
        </div>

        <p>
          Here's how I use it:
        </p>

        <ul class="space-y-2">
          <li><strong>Voice-captured task lists</strong> — I dictate action items as they occur to me, then the AI transcribes and organizes them</li>
          <li><strong>Scrum board planning</strong> — I work through sprint priorities out loud, capturing the logic and decisions</li>
          <li><strong>Meeting prep</strong> — I rehearse presentations and think through stakeholder questions during walks</li>
          <li><strong>Problem solving</strong> — I verbalize my thinking on complex challenges, creating a transcript I can review later</li>
          <li><strong>Audiobook notes</strong> — When something resonates, I pause and record my reaction and how I'll apply it</li>
        </ul>

        <p>
          The Plaud Note Pro transforms "exercise time" into one of my most documented and productive parts of the day. The AI summary feature means I can record a 45-minute stream of consciousness and get a structured output that feeds directly into my project management tools.
        </p>

        <h2 class="text-2xl font-bold text-navy-900 dark:text-white">The Real Cost of Not Exercising</h2>

        <p>
          When people tell me they don't have time to work out, I hear something else: "I'm operating at diminished capacity and I don't even realize it."
        </p>

        <p>
          The sedentary knowledge worker who skips exercise to "save time" is actually losing:
        </p>

        <ul class="space-y-2">
          <li><strong>Cognitive performance</strong> — reduced focus, slower processing, worse decision-making</li>
          <li><strong>Energy levels</strong> — that afternoon slump isn't inevitable; it's a symptom of inactivity</li>
          <li><strong>Creative thinking</strong> — breakthrough ideas rarely come from staring at a screen for 10 hours</li>
          <li><strong>Stress management</strong> — exercise is one of the most effective anxiety regulators known to science</li>
          <li><strong>Long-term health</strong> — the compounding cost of sedentary living is staggering</li>
        </ul>

        <p>
          You're not saving time by skipping the gym. You're borrowing against your future productivity at a brutal interest rate.
        </p>

        <h2 class="text-2xl font-bold text-navy-900 dark:text-white">Replace the Excuse with the Right Habits</h2>

        <p>
          The "I don't have time" excuse is comfortable because it feels true. Your calendar is full. Your responsibilities are real. But the excuse is still bad.
        </p>

        <p>
          Here's how to replace it:
        </p>

        <ol class="space-y-2">
          <li><strong>Reframe exercise as thinking time</strong> — It's not a break from work; it's a different kind of work</li>
          <li><strong>Stack your habits</strong> — Attach movement to existing routines so it becomes automatic</li>
          <li><strong>Capture your ideas</strong> — Use a tool like the Plaud Note Pro to make exercise time productive in a visible, measurable way</li>
          <li><strong>Start small</strong> — A 20-minute walk counts. A 30-minute training session counts. Don't let perfect be the enemy of good</li>
          <li><strong>Track the results</strong> — Notice how you feel and perform on days you move versus days you don't</li>
        </ol>

        <p>
          Once you build these systems, you'll stop seeing exercise as a time cost. You'll see it for what it actually is: <strong>the highest-leverage investment you can make in your daily performance.</strong>
        </p>

        <h2 class="text-2xl font-bold text-navy-900 dark:text-white">The Bottom Line</h2>

        <p>
          "Must be nice to have time to work out."
        </p>

        <p>
          No. It's <em>necessary</em> to make time to work out. The people who perform at the highest levels understand that physical movement isn't a luxury — it's a prerequisite. The time you "don't have" for exercise is time you're spending in a suboptimal cognitive state.
        </p>

        <p>
          The excuse is a bad one. Replace it with the right habits. Equip yourself with tools that capture the value of your movement time. And stop treating your body like it's separate from your brain.
        </p>

        <p>
          A body in motion is a mind in motion. That's not a platitude. It's neuroscience. And once you internalize it, you'll never look at "time" the same way again.
        </p>

      </div>

      <!-- Author Bio -->
      <div class="mt-16 pt-8 border-t border-gray-200 dark:border-navy-700">
        <div class="flex items-start gap-4">
          <img src="https://foropoulosnow.com/profile.jpg" alt="Lee Foropoulos" class="w-16 h-16 rounded-full object-cover">
          <div>
            <h3 class="font-bold text-navy-900 dark:text-white">Lee Foropoulos</h3>
            <p class="text-gray-600 dark:text-gray-400 text-sm mt-1">
              Fractional CTO, NASM-CPT, and founder of gotHABITS. Building systems that help people and businesses perform at their best.
            </p>
            <div class="flex gap-3 mt-3">
              <a href="https://linkedin.com/in/thesecretchief" target="_blank" class="text-gray-400 hover:text-gold-500 transition">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
              </a>
              <a href="https://x.com/thesecretchief" target="_blank" class="text-gray-400 hover:text-gold-500 transition">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
              </a>
            </div>
          </div>
        </div>
      </div>

      <!-- Share Section -->
      <div class="mt-12 p-8 bg-gray-50 dark:bg-navy-800 rounded-2xl text-center">
        <h3 class="text-xl font-bold text-navy-900 dark:text-white mb-2">Found this useful?</h3>
        <p class="text-gray-600 dark:text-gray-400 mb-6">Share it with someone who needs to hear it.</p>
        <div class="flex justify-center gap-3">
          <button onclick="shareOnTwitter()" class="share-btn bg-black text-white" data-tooltip="Share on X">
            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
          </button>
          <button onclick="shareOnLinkedIn()" class="share-btn bg-[#0077b5] text-white" data-tooltip="Share on LinkedIn">
            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
          </button>
          <button onclick="shareOnFacebook()" class="share-btn bg-[#1877f2] text-white" data-tooltip="Share on Facebook">
            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>
          </button>
          <button onclick="copyLink()" class="share-btn bg-gray-200 dark:bg-navy-700 text-gray-700 dark:text-gray-300" data-tooltip="Copy Link">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg>
          </button>
        </div>
      </div>

      <!-- Related Posts -->
      <div class="mt-16">
        <h3 class="text-xl font-bold text-navy-900 dark:text-white mb-6">Related Articles</h3>
        <div class="grid sm:grid-cols-2 gap-6">
          <a href="book-review-brain-rules" class="block p-6 bg-gray-50 dark:bg-navy-800 rounded-xl hover:shadow-lg transition group">
            <span class="text-xs text-gold-600 dark:text-gold-400 font-semibold">Book Review</span>
            <h4 class="font-bold text-navy-900 dark:text-white mt-2 group-hover:text-gold-600 dark:group-hover:text-gold-400 transition">Brain Rules: 12 Principles for Surviving and Thriving</h4>
            <p class="text-gray-600 dark:text-gray-400 text-sm mt-2">The neuroscience behind why exercise is the #1 brain booster.</p>
          </a>
          <a href="habit-stacking-workouts" class="block p-6 bg-gray-50 dark:bg-navy-800 rounded-xl hover:shadow-lg transition group">
            <span class="text-xs text-green-600 dark:text-green-400 font-semibold">Habits</span>
            <h4 class="font-bold text-navy-900 dark:text-white mt-2 group-hover:text-gold-600 dark:group-hover:text-gold-400 transition">Habit Stacking: Never Miss a Workout Again</h4>
            <p class="text-gray-600 dark:text-gray-400 text-sm mt-2">How linking new habits to existing routines creates automatic consistency.</p>
          </a>
        </div>
      </div>

    </div>
  </article>

  <!-- Footer -->
  <footer class="bg-navy-900 border-t border-white/10 py-8">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <a href="../../" class="text-white font-bold text-xl">Foropoulos<span class="text-gold-400">Now</span></a>
      <p class="text-gray-400 mt-2">&copy; 2026 Greek-Fire Corporation. All rights reserved.</p>
    </div>
  
    <!-- Legal Links -->
<div class="mt-8 pt-6 border-t border-white/10 flex flex-wrap justify-center gap-4 text-sm">
  <button id="cookie-settings-btn" class="text-gray-500 hover:text-gold-400 transition">Cookie Settings</button>
  <span class="text-gray-600">|</span>
  <a href="../../privacy" class="text-gray-500 hover:text-gold-400 transition">Privacy Policy</a>
</div>
  </footer>

  <!-- Back to Top Button -->
  <!-- VOICE_READER -->
<!-- Voice Reader for Blog Posts -->
<div id="voice-reader" class="fixed bottom-24 right-8 z-40 flex flex-col items-end gap-2">
  <!-- Controls (hidden by default, shown when reading) -->
  <div id="voice-controls" class="hidden bg-navy-800 rounded-xl shadow-xl border border-white/10 p-4 mb-2 min-w-[200px]">
    <!-- Voice selector -->
    <div class="mb-3">
      <label class="text-gray-400 text-xs block mb-1">Voice</label>
      <select id="voice-select" class="w-full bg-navy-700 text-white text-sm rounded-lg px-3 py-2 border border-white/10 focus:border-gold-500 focus:outline-none">
        <option value="">Loading voices...</option>
      </select>
    </div>

    <!-- Speed controls -->
    <div class="flex items-center justify-between mb-3">
      <label class="text-gray-400 text-xs">Speed</label>
      <div class="flex items-center gap-2">
        <button id="voice-slower" class="p-1.5 text-gray-400 hover:text-gold-400 transition rounded hover:bg-white/5" title="Slower">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4"></path>
          </svg>
        </button>
        <span id="voice-speed" class="text-white text-sm font-medium min-w-[3rem] text-center">1.0x</span>
        <button id="voice-faster" class="p-1.5 text-gray-400 hover:text-gold-400 transition rounded hover:bg-white/5" title="Faster">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
          </svg>
        </button>
      </div>
    </div>

    <!-- Playback controls -->
    <div class="flex items-center justify-center gap-1 mb-3">
      <button id="voice-skip-back" class="p-2 text-gray-400 hover:text-gold-400 transition rounded hover:bg-white/5" title="Previous paragraph">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12.066 11.2a1 1 0 000 1.6l5.334 4A1 1 0 0019 16V8a1 1 0 00-1.6-.8l-5.333 4zM4.066 11.2a1 1 0 000 1.6l5.334 4A1 1 0 0011 16V8a1 1 0 00-1.6-.8l-5.334 4z"></path>
        </svg>
      </button>
      <button id="voice-stop" class="p-2 text-gray-400 hover:text-red-400 transition rounded hover:bg-white/5" title="Stop">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 10a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 01-1-1v-4z"></path>
        </svg>
      </button>
      <button id="voice-skip-forward" class="p-2 text-gray-400 hover:text-gold-400 transition rounded hover:bg-white/5" title="Next paragraph">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.933 12.8a1 1 0 000-1.6L6.6 7.2A1 1 0 005 8v8a1 1 0 001.6.8l5.333-4zM19.933 12.8a1 1 0 000-1.6l-5.333-4A1 1 0 0013 8v8a1 1 0 001.6.8l5.333-4z"></path>
        </svg>
      </button>
    </div>

    <!-- Progress indicator -->
    <div class="text-xs text-gray-400 text-center">
      <span id="voice-progress">0</span> / <span id="voice-total">0</span> paragraphs
    </div>
  </div>

  <!-- Main Play/Pause Button -->
  <button id="voice-toggle" class="bg-gold-500 hover:bg-gold-400 text-navy-900 p-4 rounded-full shadow-lg transition transform hover:scale-110 group" title="Listen to article">
    <!-- Play icon -->
    <svg id="voice-play-icon" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path>
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
    </svg>
    <!-- Pause icon (hidden by default) -->
    <svg id="voice-pause-icon" class="w-6 h-6 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
    </svg>
  </button>
</div>

<style>
  /* Highlight currently reading element */
  .voice-reading {
    background: linear-gradient(90deg, rgba(245, 158, 11, 0.1) 0%, rgba(245, 158, 11, 0.2) 50%, rgba(245, 158, 11, 0.1) 100%);
    border-left: 3px solid #f59e0b;
    padding-left: 1rem;
    margin-left: -1rem;
    border-radius: 0 0.5rem 0.5rem 0;
    transition: all 0.3s ease;
  }

  .dark .voice-reading {
    background: linear-gradient(90deg, rgba(245, 158, 11, 0.05) 0%, rgba(245, 158, 11, 0.15) 50%, rgba(245, 158, 11, 0.05) 100%);
  }

  #voice-select {
    cursor: pointer;
  }
  #voice-select::-webkit-scrollbar {
    width: 6px;
  }
  #voice-select::-webkit-scrollbar-track {
    background: rgba(255,255,255,0.1);
    border-radius: 3px;
  }
  #voice-select::-webkit-scrollbar-thumb {
    background: rgba(245, 158, 11, 0.5);
    border-radius: 3px;
  }
</style>

<script>
(function() {
  'use strict';

  // Check if Speech Synthesis is supported
  if (!('speechSynthesis' in window)) {
    const voiceReader = document.getElementById('voice-reader');
    if (voiceReader) voiceReader.style.display = 'none';
    return;
  }

  const synth = window.speechSynthesis;
  let utterance = null;
  let paragraphs = [];
  let currentIndex = 0;
  let isPlaying = false;
  let isPaused = false;
  let rate = 1.0;
  let selectedVoice = null;
  let voicesLoaded = false;

  // DOM elements
  const toggleBtn = document.getElementById('voice-toggle');
  const playIcon = document.getElementById('voice-play-icon');
  const pauseIcon = document.getElementById('voice-pause-icon');
  const controls = document.getElementById('voice-controls');
  const voiceSelect = document.getElementById('voice-select');
  const speedDisplay = document.getElementById('voice-speed');
  const progressDisplay = document.getElementById('voice-progress');
  const totalDisplay = document.getElementById('voice-total');
  const slowerBtn = document.getElementById('voice-slower');
  const fasterBtn = document.getElementById('voice-faster');
  const skipBackBtn = document.getElementById('voice-skip-back');
  const skipForwardBtn = document.getElementById('voice-skip-forward');
  const stopBtn = document.getElementById('voice-stop');

  // Voice quality scoring - prioritize more natural voices
  function scoreVoice(voice) {
    let score = 0;
    const name = voice.name.toLowerCase();
    const lang = voice.lang.toLowerCase();

    // Must be English
    if (!lang.startsWith('en')) return -1000;

    // Premium/Neural voices (most natural)
    if (name.includes('neural') || name.includes('natural') || name.includes('premium')) score += 100;

    // Google voices (Chrome) - very natural
    if (name.includes('google')) score += 80;

    // Microsoft voices (Edge) - also quite good
    if (name.includes('microsoft') && (name.includes('online') || name.includes('natural'))) score += 75;

    // Apple voices (Safari)
    if (name.includes('samantha') || name.includes('alex') || name.includes('karen')) score += 70;

    // Specific high-quality voices
    if (name.includes('zira') || name.includes('david') || name.includes('mark')) score += 60;

    // Enhanced/HD voices
    if (name.includes('enhanced') || name.includes('hd') || name.includes('compact') === false) score += 30;

    // Prefer US English for consistency
    if (lang === 'en-us' || lang === 'en_us') score += 20;

    // Prefer female voices (often clearer for narration)
    if (name.includes('female') || name.includes('zira') || name.includes('samantha') || name.includes('karen') || name.includes('victoria')) score += 10;

    // Local voices are usually lower quality
    if (voice.localService && !name.includes('google') && !name.includes('microsoft')) score -= 20;

    return score;
  }

  // Get and sort voices by quality
  function loadVoices() {
    const voices = synth.getVoices();
    if (voices.length === 0) return;

    // Filter English voices and sort by quality score
    const englishVoices = voices
      .filter(v => v.lang.toLowerCase().startsWith('en'))
      .map(v => ({ voice: v, score: scoreVoice(v) }))
      .sort((a, b) => b.score - a.score)
      .map(v => v.voice);

    if (englishVoices.length === 0) return;

    // Populate dropdown
    voiceSelect.innerHTML = '';
    englishVoices.forEach((voice, index) => {
      const option = document.createElement('option');
      option.value = index;
      // Clean up voice name for display
      let displayName = voice.name
        .replace('Microsoft ', '')
        .replace('Google ', '')
        .replace(' Online (Natural)', ' (Natural)')
        .replace(' - English (United States)', '')
        .replace(' (United States)', ' (US)')
        .replace(' (United Kingdom)', ' (UK)')
        .replace(' (Australia)', ' (AU)');
      option.textContent = displayName;
      option.dataset.voiceName = voice.name;
      voiceSelect.appendChild(option);
    });

    // Select best voice by default
    selectedVoice = englishVoices[0];
    voiceSelect.value = '0';

    // Try to restore saved preference
    const savedVoice = localStorage.getItem('preferredVoice');
    if (savedVoice) {
      const savedIndex = englishVoices.findIndex(v => v.name === savedVoice);
      if (savedIndex !== -1) {
        selectedVoice = englishVoices[savedIndex];
        voiceSelect.value = savedIndex.toString();
      }
    }

    voicesLoaded = true;

    // Store voices for later reference
    voiceSelect._voices = englishVoices;
  }

  // Voice selection change
  voiceSelect.addEventListener('change', function() {
    const voices = this._voices;
    if (voices && voices[this.value]) {
      selectedVoice = voices[this.value];
      localStorage.setItem('preferredVoice', selectedVoice.name);

      // If currently playing, restart with new voice
      if (isPlaying && !isPaused) {
        synth.cancel();
        speakParagraph(currentIndex);
      }
    }
  });

  // Get article content
  function getArticleParagraphs() {
    const article = document.querySelector('article .prose');
    if (!article) return [];

    const elements = article.querySelectorAll('p, h2, h3, li');
    return Array.from(elements).filter(el => {
      const text = el.innerText.trim();
      return text.length > 0;
    });
  }

  // Update UI state
  function updateUI() {
    if (isPlaying && !isPaused) {
      playIcon.classList.add('hidden');
      pauseIcon.classList.remove('hidden');
      controls.classList.remove('hidden');
    } else if (isPaused) {
      playIcon.classList.remove('hidden');
      pauseIcon.classList.add('hidden');
      controls.classList.remove('hidden');
    } else {
      playIcon.classList.remove('hidden');
      pauseIcon.classList.add('hidden');
      controls.classList.add('hidden');
    }

    progressDisplay.textContent = currentIndex + 1;
    totalDisplay.textContent = paragraphs.length;
    speedDisplay.textContent = rate.toFixed(1) + 'x';
  }

  // Highlight current paragraph
  function highlightParagraph(index) {
    // Remove previous highlight
    document.querySelectorAll('.voice-reading').forEach(el => {
      el.classList.remove('voice-reading');
    });

    // Add highlight to current
    if (paragraphs[index]) {
      paragraphs[index].classList.add('voice-reading');

      // Smooth scroll to element
      const rect = paragraphs[index].getBoundingClientRect();
      const offset = window.innerHeight / 3;

      if (rect.top < 100 || rect.bottom > window.innerHeight - 100) {
        window.scrollTo({
          top: window.scrollY + rect.top - offset,
          behavior: 'smooth'
        });
      }
    }
  }

  // Speak a paragraph
  function speakParagraph(index) {
    if (index >= paragraphs.length) {
      stopReading();
      return;
    }

    currentIndex = index;
    highlightParagraph(index);
    updateUI();

    let text = paragraphs[index].innerText.trim();

    // Add natural pauses for better flow
    text = text
      .replace(/\. /g, '... ')  // Longer pause after sentences
      .replace(/\? /g, '?... ')
      .replace(/! /g, '!... ')
      .replace(/: /g, ':.. ')   // Medium pause after colons
      .replace(/; /g, ';.. ')
      .replace(/, /g, ', ');    // Keep commas natural

    utterance = new SpeechSynthesisUtterance(text);
    utterance.rate = rate;
    utterance.pitch = 1.0;  // Keep pitch natural
    utterance.volume = 1.0;

    // Use selected voice
    if (selectedVoice) {
      utterance.voice = selectedVoice;
    }

    utterance.onend = function() {
      if (isPlaying && !isPaused) {
        // Small pause between paragraphs for natural flow
        setTimeout(() => {
          if (isPlaying && !isPaused) {
            speakParagraph(currentIndex + 1);
          }
        }, 300);
      }
    };

    utterance.onerror = function(e) {
      if (e.error !== 'interrupted' && e.error !== 'canceled') {
        console.error('Speech error:', e.error);
        speakParagraph(currentIndex + 1);
      }
    };

    synth.speak(utterance);
  }

  // Start reading
  function startReading() {
    paragraphs = getArticleParagraphs();
    if (paragraphs.length === 0) return;

    isPlaying = true;
    isPaused = false;

    if (synth.paused) {
      synth.resume();
    } else {
      speakParagraph(currentIndex);
    }

    updateUI();
  }

  // Pause reading
  function pauseReading() {
    isPaused = true;
    synth.pause();
    updateUI();
  }

  // Resume reading
  function resumeReading() {
    isPaused = false;
    synth.resume();
    updateUI();
  }

  // Stop reading
  function stopReading() {
    isPlaying = false;
    isPaused = false;
    currentIndex = 0;
    synth.cancel();

    // Remove highlights
    document.querySelectorAll('.voice-reading').forEach(el => {
      el.classList.remove('voice-reading');
    });

    updateUI();
  }

  // Toggle button click
  toggleBtn.addEventListener('click', function() {
    if (!isPlaying) {
      startReading();
    } else if (isPaused) {
      resumeReading();
    } else {
      pauseReading();
    }
  });

  // Stop button
  stopBtn.addEventListener('click', stopReading);

  // Speed controls
  slowerBtn.addEventListener('click', function() {
    rate = Math.max(0.5, rate - 0.1);
    speedDisplay.textContent = rate.toFixed(1) + 'x';
    if (isPlaying && !isPaused) {
      synth.cancel();
      speakParagraph(currentIndex);
    }
  });

  fasterBtn.addEventListener('click', function() {
    rate = Math.min(2.0, rate + 0.1);
    speedDisplay.textContent = rate.toFixed(1) + 'x';
    if (isPlaying && !isPaused) {
      synth.cancel();
      speakParagraph(currentIndex);
    }
  });

  // Skip controls
  skipBackBtn.addEventListener('click', function() {
    if (currentIndex > 0) {
      synth.cancel();
      speakParagraph(currentIndex - 1);
    }
  });

  skipForwardBtn.addEventListener('click', function() {
    if (currentIndex < paragraphs.length - 1) {
      synth.cancel();
      speakParagraph(currentIndex + 1);
    }
  });

  // Initialize
  paragraphs = getArticleParagraphs();
  totalDisplay.textContent = paragraphs.length;

  // Load voices (async in some browsers)
  loadVoices();
  if (synth.onvoiceschanged !== undefined) {
    synth.onvoiceschanged = loadVoices;
  }

  // Restore saved speed preference
  const savedRate = localStorage.getItem('preferredRate');
  if (savedRate) {
    rate = parseFloat(savedRate);
    speedDisplay.textContent = rate.toFixed(1) + 'x';
  }

  // Save speed on change
  const originalSlower = slowerBtn.onclick;
  const originalFaster = fasterBtn.onclick;
  slowerBtn.addEventListener('click', () => localStorage.setItem('preferredRate', rate.toFixed(1)));
  fasterBtn.addEventListener('click', () => localStorage.setItem('preferredRate', rate.toFixed(1)));

  // Stop when leaving page
  window.addEventListener('beforeunload', function() {
    synth.cancel();
  });

  // Handle visibility change (pause when tab hidden)
  document.addEventListener('visibilitychange', function() {
    if (document.hidden && isPlaying && !isPaused) {
      pauseReading();
    }
  });

})();
</script>

<!-- /VOICE_READER -->

<button id="back-to-top" class="fixed bottom-8 right-8 bg-gold-500 hover:bg-gold-400 text-navy-900 p-3 rounded-full shadow-lg transition" aria-label="Back to top">
    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18"></path></svg>
  </button>

  <!-- Copy Toast -->
  <div id="copy-toast" class="copy-toast">Link copied to clipboard!</div>

  <script>
    // Dark mode toggle
    const toggle = document.getElementById('dark-mode-toggle');
    toggle.addEventListener('click', () => {
      document.documentElement.classList.toggle('dark');
      const isDark = document.documentElement.classList.contains('dark');
      document.cookie = `darkMode=${isDark}; path=/; max-age=31536000`;
    });

    // Back to top button
    const backToTop = document.getElementById('back-to-top');
    window.addEventListener('scroll', () => {
      if (window.scrollY > 500) {
        backToTop.classList.add('visible');
      } else {
        backToTop.classList.remove('visible');
      }
    });
    backToTop.addEventListener('click', () => {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });

    // Share functions
    const pageUrl = encodeURIComponent(window.location.href);
    const pageTitle = encodeURIComponent(document.title);
    const shareHook = encodeURIComponent(document.querySelector('meta[name="share:hook"]')?.content || pageTitle);

    function shareOnTwitter() {
      window.open(`https://twitter.com/intent/tweet?text=${shareHook}&url=${pageUrl}`, '_blank', 'width=550,height=420');
    }
    function shareOnLinkedIn() {
      window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${pageUrl}`, '_blank', 'width=550,height=420');
    }
    function shareOnFacebook() {
      window.open(`https://www.facebook.com/sharer/sharer.php?u=${pageUrl}`, '_blank', 'width=550,height=420');
    }
    function copyLink() {
      navigator.clipboard.writeText(window.location.href);
      const toast = document.getElementById('copy-toast');
      toast.classList.add('show');
      setTimeout(() => toast.classList.remove('show'), 2000);
    }
  </script>

<!-- MUSIC_PLAYER -->
<!-- Ambient Music Player -->
<div id="music-player" class="fixed bottom-8 left-8 z-[60] opacity-0 translate-y-4 transition-all duration-500">
  <!-- Expanded Player Panel -->
  <div id="music-panel" class="hidden mb-3 bg-navy-900/95 backdrop-blur-xl rounded-2xl shadow-2xl border border-white/10 overflow-hidden w-72">
    <!-- Track Visualizer Header -->
    <div class="relative h-24 bg-gradient-to-br from-gold-500/20 via-purple-500/20 to-blue-500/20 overflow-hidden">
      <div id="music-visualizer" class="absolute inset-0 flex items-end justify-center gap-1 px-4 pb-2"></div>
      <div class="absolute inset-0 bg-gradient-to-t from-navy-900/90 to-transparent"></div>
      <div class="absolute bottom-2 left-4 right-4">
        <p id="music-track-name" class="text-white font-semibold text-sm truncate">Select a track</p>
        <p id="music-track-artist" class="text-gray-400 text-xs truncate">Ambient Soundscapes</p>
      </div>
    </div>

    <!-- Track Selector -->
    <div class="p-4 border-b border-white/10">
      <label class="text-gray-400 text-xs block mb-2">Atmosphere</label>
      <select id="music-track-select" class="w-full bg-navy-800 text-white text-sm rounded-lg px-3 py-2.5 border border-white/10 focus:border-gold-500 focus:outline-none cursor-pointer">
        <option value="">Choose your vibe...</option>
        <optgroup label="Relaxing">
          <option value="acoustic-guitar">Acoustic Bossa Nova</option>
          <option value="stardust">Stardust Meditation</option>
        </optgroup>
        <optgroup label="Focus">
          <option value="flow-state">Flow State</option>
          <option value="morning-clarity">Morning Clarity</option>
        </optgroup>
        <optgroup label="Atmospheric">
          <option value="cosmic">Cosmic Journey</option>
          <option value="noir">Noir Atmosphere</option>
          <option value="sunrise">Golden Sunrise</option>
        </optgroup>
      </select>
    </div>

    <!-- Progress Bar -->
    <div class="px-4 pt-4">
      <div id="music-progress-container" class="h-1.5 bg-navy-700 rounded-full cursor-pointer relative group">
        <div id="music-progress-bar" class="h-full bg-gradient-to-r from-gold-500 to-gold-400 rounded-full transition-all duration-100" style="width: 0%"></div>
        <div id="music-progress-handle" class="absolute top-1/2 -translate-y-1/2 w-3 h-3 bg-white rounded-full shadow-lg opacity-0 group-hover:opacity-100 transition-opacity cursor-grab" style="left: 0%"></div>
      </div>
      <div class="flex justify-between text-gray-500 text-xs mt-1">
        <span id="music-time-current">0:00</span>
        <span id="music-time-duration">0:00</span>
      </div>
    </div>

    <!-- Playback Controls -->
    <div class="p-4 flex items-center justify-center gap-4">
      <button id="music-play-btn" class="w-14 h-14 rounded-full bg-gold-500 hover:bg-gold-400 text-navy-900 flex items-center justify-center transition transform hover:scale-105 shadow-lg">
        <svg id="music-play-icon" class="w-6 h-6 ml-1" fill="currentColor" viewBox="0 0 24 24">
          <path d="M8 5v14l11-7z"></path>
        </svg>
        <svg id="music-pause-icon" class="w-6 h-6 hidden" fill="currentColor" viewBox="0 0 24 24">
          <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"></path>
        </svg>
      </button>
    </div>

    <!-- Volume Control -->
    <div class="px-4 pb-4">
      <div class="flex items-center gap-3">
        <button id="music-mute" class="text-gray-400 hover:text-white transition">
          <svg id="music-volume-icon" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072M18.364 5.636a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"></path>
          </svg>
          <svg id="music-mute-icon" class="w-5 h-5 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2"></path>
          </svg>
        </button>
        <div id="music-volume-container" class="flex-1 h-2 bg-navy-700 rounded-full cursor-pointer relative group">
          <div id="music-volume-bar" class="h-full bg-gradient-to-r from-gold-500 to-gold-400 rounded-full transition-all" style="width: 70%"></div>
          <div id="music-volume-handle" class="absolute top-1/2 -translate-y-1/2 w-4 h-4 bg-white rounded-full shadow-lg cursor-grab" style="left: 70%"></div>
        </div>
        <span id="music-volume-value" class="text-gray-400 text-xs w-8">70%</span>
      </div>
    </div>

    <div class="px-4 pb-3 text-center">
      <p class="text-gray-500 text-xs">Premium ambient soundscapes</p>
    </div>
  </div>

  <!-- Floating Toggle Button -->
  <button id="music-toggle" class="relative bg-navy-900/90 hover:bg-navy-800 backdrop-blur-xl text-white p-4 rounded-full shadow-2xl border border-white/10 transition-all duration-300 hover:scale-110 hover:border-gold-500/50 group" style="pointer-events: auto !important; z-index: 9999 !important;">
    <div id="music-pulse" class="absolute inset-0 rounded-full border-2 border-gold-500/50 animate-ping hidden"></div>
    <svg id="music-note-icon" class="w-6 h-6 text-gold-400 group-hover:text-gold-300 transition" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"></path>
    </svg>
    <div id="music-eq-mini" class="absolute inset-0 flex items-center justify-center gap-0.5 hidden">
      <span class="w-1 h-3 bg-gold-400 rounded-full animate-eq-1"></span>
      <span class="w-1 h-4 bg-gold-400 rounded-full animate-eq-2"></span>
      <span class="w-1 h-2 bg-gold-400 rounded-full animate-eq-3"></span>
      <span class="w-1 h-3 bg-gold-400 rounded-full animate-eq-4"></span>
    </div>
    <span id="music-badge" class="absolute -top-1 -right-1 w-3 h-3 bg-gold-500 rounded-full hidden">
      <span class="absolute inset-0 rounded-full bg-gold-500 animate-ping"></span>
    </span>
  </button>

  <!-- Welcome notification -->
  <div id="music-welcome" class="absolute bottom-full left-0 mb-3 hidden opacity-0 transition-opacity duration-500 w-64">
    <div class="bg-navy-800/95 backdrop-blur-xl rounded-xl p-4 shadow-2xl border border-gold-500/20 relative">
      <div class="absolute -bottom-2 left-6 w-4 h-4 bg-navy-800/95 border-r border-b border-gold-500/20 transform rotate-45"></div>
      <div class="flex items-center gap-2 mb-2">
        <div class="w-8 h-8 rounded-full bg-gold-500/20 flex items-center justify-center">
          <svg class="w-4 h-4 text-gold-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"></path>
          </svg>
        </div>
        <span class="text-gold-400 font-semibold text-sm">Enhance Your Experience</span>
      </div>
      <p class="text-gray-300 text-xs leading-relaxed mb-3">
        Enable ambient music for an immersive browsing experience.
      </p>
      <div class="flex gap-2">
        <button id="music-welcome-play" class="flex-1 bg-gold-500 hover:bg-gold-400 text-navy-900 text-xs font-semibold py-2 px-3 rounded-lg transition transform hover:scale-105">
          Play Music
        </button>
        <button id="music-welcome-dismiss" class="px-3 py-2 text-gray-400 hover:text-white text-xs rounded-lg border border-white/10 hover:border-white/30 transition">
          Later
        </button>
      </div>
    </div>
  </div>
</div>

<style>
  #music-player.visible { opacity: 1; transform: translateY(0); }
  @keyframes eq-1 { 0%, 100% { height: 4px; } 50% { height: 16px; } }
  @keyframes eq-2 { 0%, 100% { height: 8px; } 50% { height: 20px; } }
  @keyframes eq-3 { 0%, 100% { height: 12px; } 50% { height: 8px; } }
  @keyframes eq-4 { 0%, 100% { height: 6px; } 50% { height: 14px; } }
  .animate-eq-1 { animation: eq-1 0.8s ease-in-out infinite; }
  .animate-eq-2 { animation: eq-2 0.6s ease-in-out infinite 0.1s; }
  .animate-eq-3 { animation: eq-3 0.7s ease-in-out infinite 0.2s; }
  .animate-eq-4 { animation: eq-4 0.5s ease-in-out infinite 0.15s; }
  .visualizer-bar { width: 4px; background: linear-gradient(to top, #f59e0b, #fbbf24); border-radius: 2px; transition: height 0.1s ease; }
  #music-track-select { appearance: none; background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%239ca3af'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E"); background-repeat: no-repeat; background-position: right 0.75rem center; background-size: 1rem; }
  #music-welcome.show { opacity: 1; }
  @keyframes welcome-glow { 0%, 100% { box-shadow: 0 0 20px rgba(245, 158, 11, 0.2); } 50% { box-shadow: 0 0 40px rgba(245, 158, 11, 0.4); } }
  #music-welcome.show > div { animation: welcome-glow 2s ease-in-out infinite; }
</style>

<script>
(function() {
  'use strict';

  // Version for cache clearing on updates
  const MUSIC_VERSION = '5';
  if (localStorage.getItem('musicVersion') !== MUSIC_VERSION) {
    localStorage.removeItem('musicTrack');
    localStorage.removeItem('musicEnabled');
    localStorage.removeItem('musicWelcomeSeen');
    localStorage.removeItem('userSelectedTrack');
    localStorage.setItem('musicVersion', MUSIC_VERSION);
  }

  // Track definitions with MP3 file paths
  const TRACKS = {
    'acoustic-guitar': {
      name: 'Acoustic Bossa Nova',
      artist: 'Relaxing Vibes',
      file: '/audio/acoustic-guitar-bossa-nova-295307.mp3',
      mood: 'relaxing'
    },
    'stardust': {
      name: 'Stardust Meditation',
      artist: 'Deep Relaxation',
      file: '/audio/stardust-meditation-12702.mp3',
      mood: 'meditative'
    },
    'flow-state': {
      name: 'Flow State',
      artist: 'Focus & Productivity',
      file: '/audio/flow-state-ambient-music-374741.mp3',
      mood: 'focus'
    },
    'morning-clarity': {
      name: 'Morning Clarity',
      artist: 'Fresh Start',
      file: '/audio/morning-clarity-443232.mp3',
      mood: 'uplifting'
    },
    'cosmic': {
      name: 'Cosmic Journey',
      artist: 'Stellar Motivation',
      file: '/audio/cosmic-stellar-journey-motivation-322778.mp3',
      mood: 'epic'
    },
    'noir': {
      name: 'Noir Atmosphere',
      artist: 'Dark Ambiance',
      file: '/audio/noir-alley-415342.mp3',
      mood: 'dark'
    },
    'sunrise': {
      name: 'Golden Sunrise',
      artist: 'New Beginnings',
      file: '/audio/sunrise-337749.mp3',
      mood: 'bright'
    }
  };

  // Intelligent page-to-track mapping based on content type and path
  function getPageTrack() {
    const path = window.location.pathname.toLowerCase();
    const meta = document.querySelector('meta[name="ambient:music"]');

    // If page has explicit meta tag, use that
    if (meta && meta.content && TRACKS[meta.content]) {
      return meta.content;
    }

    // Main pages
    if (path === '/' || path === '/index.html') return 'sunrise';
    if (path.includes('/blog/index') || path === '/blog/' || path === '/blog') return 'sunrise';
    if (path.includes('/privacy')) return 'noir';

    // Blog post categories
    if (path.includes('/blog/posts/')) {
      // AI & Tech articles - focus music
      if (path.includes('ai-') || path.includes('claude') || path.includes('chatgpt') ||
          path.includes('agent') || path.includes('automation') || path.includes('ram-ssd')) {
        return 'flow-state';
      }
      // Health & Fitness - morning clarity
      if (path.includes('bmr') || path.includes('protein') || path.includes('supplement') ||
          path.includes('workout') || path.includes('habit')) {
        return 'morning-clarity';
      }
      // Book reviews - acoustic relaxation
      if (path.includes('book-review')) {
        if (path.includes('dungeon-crawler')) return 'noir';
        if (path.includes('ceo-excellence')) return 'cosmic';
        if (path.includes('brain-rules')) return 'flow-state';
        return 'acoustic-guitar';
      }
      // Productivity & Business
      if (path.includes('morning-routine') || path.includes('ceo')) return 'morning-clarity';
      if (path.includes('fractional') || path.includes('breaking-big-tasks')) return 'flow-state';
      if (path.includes('slop')) return 'noir';

      // Default blog post
      return 'flow-state';
    }

    // Experience pages - cosmic/motivational
    if (path.includes('/experience/')) {
      return 'cosmic';
    }

    // Profile pages - meditative
    if (path.includes('/profiles/')) {
      return 'stardust';
    }

    // Ventures - cosmic/entrepreneurial
    if (path.includes('/ventures/')) {
      return 'cosmic';
    }

    // Default fallback
    return 'sunrise';
  }

  let audio = null;
  let audioContext = null;
  let analyser = null;
  let isPlaying = false;
  let currentTrackId = null;
  let volume = 0.7;
  let animationId = null;

  const player = document.getElementById('music-player');
  if (!player) return;

  const panel = document.getElementById('music-panel');
  const toggleBtn = document.getElementById('music-toggle');
  const playBtn = document.getElementById('music-play-btn');
  const playIcon = document.getElementById('music-play-icon');
  const pauseIcon = document.getElementById('music-pause-icon');
  const trackSelect = document.getElementById('music-track-select');
  const trackName = document.getElementById('music-track-name');
  const trackArtist = document.getElementById('music-track-artist');
  const volumeBar = document.getElementById('music-volume-bar');
  const volumeHandle = document.getElementById('music-volume-handle');
  const volumeContainer = document.getElementById('music-volume-container');
  const volumeValue = document.getElementById('music-volume-value');
  const muteBtn = document.getElementById('music-mute');
  const volumeIcon = document.getElementById('music-volume-icon');
  const muteIcon = document.getElementById('music-mute-icon');
  const visualizer = document.getElementById('music-visualizer');
  const pulse = document.getElementById('music-pulse');
  const noteIcon = document.getElementById('music-note-icon');
  const eqMini = document.getElementById('music-eq-mini');
  const welcomeEl = document.getElementById('music-welcome');
  const welcomePlayBtn = document.getElementById('music-welcome-play');
  const welcomeDismissBtn = document.getElementById('music-welcome-dismiss');
  const musicBadge = document.getElementById('music-badge');
  const progressContainer = document.getElementById('music-progress-container');
  const progressBar = document.getElementById('music-progress-bar');
  const progressHandle = document.getElementById('music-progress-handle');
  const timeCurrent = document.getElementById('music-time-current');
  const timeDuration = document.getElementById('music-time-duration');

  // Persistence helpers
  function setMusicEnabled(enabled) { localStorage.setItem('musicEnabled', enabled ? 'true' : 'false'); }
  function isMusicEnabled() { return localStorage.getItem('musicEnabled') === 'true'; }
  function setUserTrack(trackId) { localStorage.setItem('userSelectedTrack', trackId); }
  function getUserTrack() { return localStorage.getItem('userSelectedTrack'); }

  // Cross-page playback persistence
  function savePlaybackState() {
    if (audio && isPlaying && currentTrackId) {
      const state = {
        trackId: currentTrackId,
        position: audio.currentTime,
        timestamp: Date.now()
      };
      localStorage.setItem('musicPlaybackState', JSON.stringify(state));
    }
  }

  function getPlaybackState() {
    try {
      const stateStr = localStorage.getItem('musicPlaybackState');
      if (!stateStr) return null;
      const state = JSON.parse(stateStr);
      // Only use state if it's less than 5 seconds old (fresh navigation)
      if (Date.now() - state.timestamp < 5000) {
        return state;
      }
      localStorage.removeItem('musicPlaybackState');
      return null;
    } catch (e) {
      return null;
    }
  }

  function clearPlaybackState() {
    localStorage.removeItem('musicPlaybackState');
  }

  // Save state before leaving page
  window.addEventListener('beforeunload', savePlaybackState);
  // Also save periodically while playing (every 2 seconds)
  setInterval(() => {
    if (isPlaying) savePlaybackState();
  }, 2000);

  function showWelcome() {
    if (localStorage.getItem('musicWelcomeSeen')) return;
    if (musicBadge) musicBadge.classList.remove('hidden');
    setTimeout(() => {
      if (welcomeEl && !isPlaying) {
        welcomeEl.classList.remove('hidden');
        setTimeout(() => welcomeEl.classList.add('show'), 50);
      }
    }, 3000);
  }

  function hideWelcome(permanent = false) {
    if (welcomeEl) {
      welcomeEl.classList.remove('show');
      setTimeout(() => welcomeEl.classList.add('hidden'), 500);
    }
    if (musicBadge) musicBadge.classList.add('hidden');
    if (permanent) localStorage.setItem('musicWelcomeSeen', 'true');
  }

  function formatTime(seconds) {
    if (isNaN(seconds)) return '0:00';
    const mins = Math.floor(seconds / 60);
    const secs = Math.floor(seconds % 60);
    return `${mins}:${secs.toString().padStart(2, '0')}`;
  }

  function initAudio() {
    if (!audio) {
      audio = new Audio();
      audio.loop = true;
      audio.volume = volume;
      audio.crossOrigin = 'anonymous';

      audio.addEventListener('loadedmetadata', () => {
        if (timeDuration) timeDuration.textContent = formatTime(audio.duration);
      });

      audio.addEventListener('timeupdate', () => {
        if (audio.duration) {
          const percent = (audio.currentTime / audio.duration) * 100;
          if (progressBar) progressBar.style.width = `${percent}%`;
          if (progressHandle) progressHandle.style.left = `${percent}%`;
          if (timeCurrent) timeCurrent.textContent = formatTime(audio.currentTime);
        }
      });

      audio.addEventListener('ended', () => {
        // Loop is enabled, but just in case
        audio.currentTime = 0;
        audio.play().catch(() => {});
      });

      audio.addEventListener('error', (e) => {
        console.warn('Audio load error:', e);
      });
    }

    // Set up Web Audio API for visualizer
    if (!audioContext) {
      try {
        audioContext = new (window.AudioContext || window.webkitAudioContext)();
        analyser = audioContext.createAnalyser();
        analyser.fftSize = 64;
        const source = audioContext.createMediaElementSource(audio);
        source.connect(analyser);
        analyser.connect(audioContext.destination);
      } catch (e) {
        console.warn('Web Audio API not available for visualizer');
      }
    }
  }

  function loadTrack(trackId, startPosition = 0) {
    if (!TRACKS[trackId]) return;

    initAudio();

    const track = TRACKS[trackId];
    currentTrackId = trackId;

    // Update UI
    if (trackName) trackName.textContent = track.name;
    if (trackArtist) trackArtist.textContent = track.artist;
    if (trackSelect) trackSelect.value = trackId;

    // Load the audio file
    audio.src = track.file;

    // Set start position once audio is ready
    if (startPosition > 0) {
      audio.addEventListener('loadedmetadata', function onLoaded() {
        audio.currentTime = Math.min(startPosition, audio.duration - 1);
        audio.removeEventListener('loadedmetadata', onLoaded);
      }, { once: true });
    }

    audio.load();
  }

  function play() {
    if (!currentTrackId) {
      // Determine which track to play
      // Priority: 1. User preference, 2. Page-specific track
      const userTrack = getUserTrack();
      const pageTrack = getPageTrack();
      const trackToPlay = userTrack || pageTrack;
      loadTrack(trackToPlay);
    }

    if (audioContext && audioContext.state === 'suspended') {
      audioContext.resume();
    }

    audio.play().then(() => {
      isPlaying = true;
      setMusicEnabled(true);
      updatePlayButton();
      animateVisualizer();
      hideWelcome(true);
    }).catch((e) => {
      console.warn('Playback failed:', e);
    });
  }

  function pause() {
    if (audio) {
      audio.pause();
    }
    isPlaying = false;
    updatePlayButton();
    if (animationId) {
      cancelAnimationFrame(animationId);
      animationId = null;
    }
  }

  function togglePlay() {
    isPlaying ? pause() : play();
  }

  function updatePlayButton() {
    if (isPlaying) {
      if (playIcon) playIcon.classList.add('hidden');
      if (pauseIcon) pauseIcon.classList.remove('hidden');
      if (pulse) pulse.classList.remove('hidden');
      if (noteIcon) noteIcon.classList.add('hidden');
      if (eqMini) eqMini.classList.remove('hidden');
    } else {
      if (playIcon) playIcon.classList.remove('hidden');
      if (pauseIcon) pauseIcon.classList.add('hidden');
      if (pulse) pulse.classList.add('hidden');
      if (noteIcon) noteIcon.classList.remove('hidden');
      if (eqMini) eqMini.classList.add('hidden');
    }
  }

  function updateVolumeUI() {
    const percent = volume * 100;
    if (volumeBar) volumeBar.style.width = `${percent}%`;
    if (volumeHandle) volumeHandle.style.left = `${percent}%`;
    if (volumeValue) volumeValue.textContent = `${Math.round(percent)}%`;
    if (volume === 0) {
      if (volumeIcon) volumeIcon.classList.add('hidden');
      if (muteIcon) muteIcon.classList.remove('hidden');
    } else {
      if (volumeIcon) volumeIcon.classList.remove('hidden');
      if (muteIcon) muteIcon.classList.add('hidden');
    }
  }

  function createVisualizerBars() {
    if (!visualizer) return;
    visualizer.innerHTML = '';
    for (let i = 0; i < 32; i++) {
      const bar = document.createElement('div');
      bar.className = 'visualizer-bar';
      bar.style.height = '4px';
      visualizer.appendChild(bar);
    }
  }

  function animateVisualizer() {
    if (!isPlaying || !visualizer) {
      if (animationId) cancelAnimationFrame(animationId);
      return;
    }

    const bars = visualizer.querySelectorAll('.visualizer-bar');

    if (analyser) {
      const dataArray = new Uint8Array(analyser.frequencyBinCount);
      analyser.getByteFrequencyData(dataArray);
      bars.forEach((bar, i) => {
        const value = dataArray[i] || 0;
        bar.style.height = `${Math.max(4, (value / 255) * 60)}px`;
      });
    } else {
      // Fallback animation when Web Audio API isn't available
      bars.forEach((bar, i) => {
        const value = Math.random() * 0.5 + 0.3;
        bar.style.height = `${Math.max(4, value * 40)}px`;
      });
    }

    animationId = requestAnimationFrame(animateVisualizer);
  }

  function bindEvents() {
    if (toggleBtn && panel) {
      toggleBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        panel.classList.toggle('hidden');
        hideWelcome(true);
      });
    }

    // Click outside to close panel
    document.addEventListener('click', (e) => {
      if (panel && !panel.classList.contains('hidden')) {
        if (!panel.contains(e.target) && !toggleBtn.contains(e.target)) {
          panel.classList.add('hidden');
        }
      }
    });

    // Prevent clicks inside panel from closing it
    if (panel) {
      panel.addEventListener('click', (e) => {
        e.stopPropagation();
      });
    }

    if (welcomePlayBtn) {
      welcomePlayBtn.addEventListener('click', () => {
        hideWelcome(true);
        if (panel) panel.classList.remove('hidden');
        play();
      });
    }

    if (welcomeDismissBtn) {
      welcomeDismissBtn.addEventListener('click', () => {
        hideWelcome(true);
        setMusicEnabled(false);
      });
    }

    if (playBtn) playBtn.addEventListener('click', togglePlay);

    if (trackSelect) {
      trackSelect.addEventListener('change', (e) => {
        if (e.target.value) {
          // User explicitly selected a track - save preference
          setUserTrack(e.target.value);
          loadTrack(e.target.value);
          play();
        }
      });
    }

    // Progress bar seek
    if (progressContainer) {
      progressContainer.addEventListener('click', (e) => {
        if (!audio || !audio.duration) return;
        const rect = progressContainer.getBoundingClientRect();
        const percent = Math.max(0, Math.min(1, (e.clientX - rect.left) / rect.width));
        audio.currentTime = percent * audio.duration;
      });
    }

    // Volume control
    if (volumeContainer) {
      volumeContainer.addEventListener('click', (e) => {
        const rect = volumeContainer.getBoundingClientRect();
        volume = Math.max(0, Math.min(1, (e.clientX - rect.left) / rect.width));
        if (audio) audio.volume = volume;
        localStorage.setItem('musicVolume', volume);
        updateVolumeUI();
      });
    }

    if (muteBtn) {
      muteBtn.addEventListener('click', () => {
        volume = volume === 0 ? 0.7 : 0;
        if (audio) audio.volume = volume;
        updateVolumeUI();
      });
    }
  }

  function init() {
    // Check for saved playback state from previous page
    const savedState = getPlaybackState();

    // Get the appropriate track for this page
    const pageTrack = getPageTrack();
    const userTrack = getUserTrack();

    // If we have a saved state from navigation, use that track
    // Otherwise use user preference or page default
    const displayTrack = savedState ? savedState.trackId : (userTrack || pageTrack);

    // Restore saved volume
    const savedVolume = localStorage.getItem('musicVolume');
    if (savedVolume) {
      volume = parseFloat(savedVolume);
      updateVolumeUI();
    }

    // Set the track selector to show appropriate track
    if (trackSelect) trackSelect.value = displayTrack;

    // Update track display
    if (TRACKS[displayTrack]) {
      if (trackName) trackName.textContent = TRACKS[displayTrack].name;
      if (trackArtist) trackArtist.textContent = TRACKS[displayTrack].artist;
    }

    createVisualizerBars();
    bindEvents();

    const musicWasEnabled = isMusicEnabled();

    // If we have a fresh saved state, resume immediately
    if (savedState && musicWasEnabled) {
      player.classList.add('visible');
      loadTrack(savedState.trackId, savedState.position);
      // Small delay to ensure audio is ready
      setTimeout(() => {
        play();
        clearPlaybackState();
      }, 100);
    } else {
      // Normal startup with slight delay
      setTimeout(() => {
        player.classList.add('visible');
        if (musicWasEnabled) {
          loadTrack(displayTrack);
          play();
        } else {
          showWelcome();
        }
      }, 500);
    }
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', init);
  } else {
    init();
  }
})();
</script>

<!-- /MUSIC_PLAYER -->
<!-- COOKIE_CONSENT -->
<!-- Cookie Consent Banner -->
<div id="cookie-consent" class="fixed bottom-0 left-0 right-0 z-[100] transform translate-y-full transition-transform duration-500" role="dialog" aria-labelledby="cookie-consent-title" aria-describedby="cookie-consent-description">
  <div class="bg-navy-900/98 backdrop-blur-lg border-t border-white/10 shadow-2xl">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
      <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4">
        <div class="flex-1">
          <h3 id="cookie-consent-title" class="text-white font-semibold text-lg mb-2">We value your privacy</h3>
          <p id="cookie-consent-description" class="text-gray-400 text-sm leading-relaxed">
            We use cookies to enhance your browsing experience, analyze site traffic, and personalize content.
            By clicking "Accept All", you consent to our use of cookies. You can manage your preferences anytime.
          </p>
        </div>
        <div class="flex flex-col sm:flex-row gap-3 lg:ml-8">
          <button id="cookie-customize" class="px-5 py-2.5 text-gray-300 hover:text-white border border-white/20 hover:border-white/40 rounded-full text-sm font-medium transition">
            Customize
          </button>
          <button id="cookie-reject" class="px-5 py-2.5 text-gray-300 hover:text-white border border-white/20 hover:border-white/40 rounded-full text-sm font-medium transition">
            Reject All
          </button>
          <button id="cookie-accept" class="px-6 py-2.5 bg-gold-500 hover:bg-gold-400 text-navy-900 rounded-full text-sm font-semibold transition transform hover:scale-105">
            Accept All
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Cookie Settings Modal -->
<div id="cookie-modal" class="fixed inset-0 z-[110] hidden" role="dialog" aria-modal="true" aria-labelledby="cookie-modal-title">
  <div class="fixed inset-0 bg-black/60 backdrop-blur-sm" id="cookie-modal-backdrop"></div>
  <div class="fixed inset-0 overflow-y-auto">
    <div class="flex min-h-full items-center justify-center p-4">
      <div class="bg-navy-800 rounded-2xl shadow-2xl max-w-lg w-full border border-white/10 transform transition-all">
        <div class="p-6 border-b border-white/10">
          <div class="flex items-center justify-between">
            <h3 id="cookie-modal-title" class="text-xl font-bold text-white">Cookie Preferences</h3>
            <button id="cookie-modal-close" class="text-gray-400 hover:text-white transition" aria-label="Close modal">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
              </svg>
            </button>
          </div>
          <p class="text-gray-400 text-sm mt-2">Manage your cookie preferences below. Essential cookies are always active as they're necessary for the site to function.</p>
        </div>

        <div class="p-6 space-y-4">
          <!-- Essential Cookies -->
          <div class="flex items-start justify-between p-4 bg-white/5 rounded-xl">
            <div class="flex-1 pr-4">
              <h4 class="text-white font-semibold">Essential Cookies</h4>
              <p class="text-gray-400 text-sm mt-1">Required for basic site functionality like navigation and secure access. Cannot be disabled.</p>
            </div>
            <div class="relative">
              <input type="checkbox" id="cookie-essential" checked disabled class="sr-only">
              <div class="w-11 h-6 bg-gold-500 rounded-full opacity-50 cursor-not-allowed">
                <div class="absolute top-0.5 left-5 w-5 h-5 bg-white rounded-full shadow"></div>
              </div>
            </div>
          </div>

          <!-- Analytics Cookies -->
          <div class="flex items-start justify-between p-4 bg-white/5 rounded-xl">
            <div class="flex-1 pr-4">
              <label for="cookie-analytics" class="text-white font-semibold cursor-pointer">Analytics Cookies</label>
              <p class="text-gray-400 text-sm mt-1">Help us understand how visitors interact with our site. We use Google Analytics and Microsoft Clarity.</p>
            </div>
            <label for="cookie-analytics" class="relative cursor-pointer">
              <input type="checkbox" id="cookie-analytics" class="sr-only peer">
              <div class="w-11 h-6 bg-gray-600 peer-checked:bg-gold-500 rounded-full transition-colors"></div>
              <div class="absolute top-0.5 left-0.5 peer-checked:left-5 w-5 h-5 bg-white rounded-full shadow transition-all"></div>
            </label>
          </div>

          <!-- Marketing Cookies -->
          <div class="flex items-start justify-between p-4 bg-white/5 rounded-xl">
            <div class="flex-1 pr-4">
              <label for="cookie-marketing" class="text-white font-semibold cursor-pointer">Marketing Cookies</label>
              <p class="text-gray-400 text-sm mt-1">Used to track visitors across websites to display relevant ads and measure campaign effectiveness.</p>
            </div>
            <label for="cookie-marketing" class="relative cursor-pointer">
              <input type="checkbox" id="cookie-marketing" class="sr-only peer">
              <div class="w-11 h-6 bg-gray-600 peer-checked:bg-gold-500 rounded-full transition-colors"></div>
              <div class="absolute top-0.5 left-0.5 peer-checked:left-5 w-5 h-5 bg-white rounded-full shadow transition-all"></div>
            </label>
          </div>
        </div>

        <div class="p-6 border-t border-white/10 flex justify-end gap-3">
          <button id="cookie-modal-reject" class="px-5 py-2.5 text-gray-300 hover:text-white border border-white/20 hover:border-white/40 rounded-full text-sm font-medium transition">
            Reject All
          </button>
          <button id="cookie-modal-save" class="px-6 py-2.5 bg-gold-500 hover:bg-gold-400 text-navy-900 rounded-full text-sm font-semibold transition">
            Save Preferences
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- /COOKIE_CONSENT -->


<!-- SHARED_SCRIPTS -->
<script>
// ===== COOKIE UTILITIES =====
function getCookie(name) {
  const match = document.cookie.match(new RegExp('(^| )' + name + '=([^;]+)'));
  return match ? match[2] : null;
}

function setCookie(name, value, days) {
  const expires = new Date(Date.now() + days * 864e5).toUTCString();
  document.cookie = name + '=' + encodeURIComponent(value) + '; expires=' + expires + '; path=/; SameSite=Lax';
}

function deleteCookie(name) {
  document.cookie = name + '=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';
}

// ===== COOKIE CONSENT MANAGEMENT =====
const CookieConsent = {
  CONSENT_COOKIE: 'cookieConsent',
  CONSENT_VERSION: '1.0',

  getConsent() {
    const consent = getCookie(this.CONSENT_COOKIE);
    if (!consent) return null;
    try {
      return JSON.parse(decodeURIComponent(consent));
    } catch (e) {
      return null;
    }
  },

  setConsent(preferences) {
    const consent = {
      version: this.CONSENT_VERSION,
      timestamp: new Date().toISOString(),
      essential: true, // Always true
      analytics: preferences.analytics || false,
      marketing: preferences.marketing || false
    };
    setCookie(this.CONSENT_COOKIE, JSON.stringify(consent), 365);
    return consent;
  },

  hasConsent() {
    return this.getConsent() !== null;
  },

  hasAnalyticsConsent() {
    const consent = this.getConsent();
    return consent && consent.analytics === true;
  },

  hasMarketingConsent() {
    const consent = this.getConsent();
    return consent && consent.marketing === true;
  },

  showBanner() {
    const banner = document.getElementById('cookie-consent');
    if (banner) {
      banner.classList.remove('translate-y-full');
    }
  },

  hideBanner() {
    const banner = document.getElementById('cookie-consent');
    if (banner) {
      banner.classList.add('translate-y-full');
    }
  },

  showModal() {
    const modal = document.getElementById('cookie-modal');
    if (modal) {
      modal.classList.remove('hidden');
      document.body.style.overflow = 'hidden';
      // Set checkboxes to current preferences
      const consent = this.getConsent() || { analytics: false, marketing: false };
      const analyticsCheckbox = document.getElementById('cookie-analytics');
      const marketingCheckbox = document.getElementById('cookie-marketing');
      if (analyticsCheckbox) analyticsCheckbox.checked = consent.analytics;
      if (marketingCheckbox) marketingCheckbox.checked = consent.marketing;
    }
  },

  hideModal() {
    const modal = document.getElementById('cookie-modal');
    if (modal) {
      modal.classList.add('hidden');
      document.body.style.overflow = '';
    }
  },

  acceptAll() {
    const consent = this.setConsent({ analytics: true, marketing: true });
    this.hideBanner();
    this.hideModal();
    this.applyConsent(consent);
    if (typeof siteAnalytics !== 'undefined') {
      siteAnalytics.trackEvent('cookie_consent', { consent_type: 'accept_all' });
    }
  },

  rejectAll() {
    const consent = this.setConsent({ analytics: false, marketing: false });
    this.hideBanner();
    this.hideModal();
    this.applyConsent(consent);
  },

  savePreferences() {
    const analyticsCheckbox = document.getElementById('cookie-analytics');
    const marketingCheckbox = document.getElementById('cookie-marketing');
    const consent = this.setConsent({
      analytics: analyticsCheckbox ? analyticsCheckbox.checked : false,
      marketing: marketingCheckbox ? marketingCheckbox.checked : false
    });
    this.hideBanner();
    this.hideModal();
    this.applyConsent(consent);
    if (consent.analytics && typeof siteAnalytics !== 'undefined') {
      siteAnalytics.trackEvent('cookie_consent', { consent_type: 'custom', analytics: consent.analytics, marketing: consent.marketing });
    }
  },

  applyConsent(consent) {
    // Dispatch event for analytics.js to listen to
    window.dispatchEvent(new CustomEvent('cookieConsentUpdated', { detail: consent }));
  },

  init() {
    if (!this.hasConsent()) {
      // Show banner after a short delay for better UX
      setTimeout(() => this.showBanner(), 1000);
    } else {
      // Apply existing consent
      this.applyConsent(this.getConsent());
    }
  }
};

// ===== MOBILE MENU =====
function initMobileMenu() {
  const mobileMenuBtn = document.getElementById('mobile-menu-btn');
  const closeMenuBtn = document.getElementById('close-menu');
  const mobileMenu = document.getElementById('mobile-menu');
  const menuOverlay = document.getElementById('menu-overlay');

  if (!mobileMenuBtn || !mobileMenu) return;

  function openMobileMenu() {
    mobileMenu.classList.add('open');
    if (menuOverlay) menuOverlay.classList.add('open');
    document.body.style.overflow = 'hidden';
  }

  function closeMobileMenu() {
    mobileMenu.classList.remove('open');
    if (menuOverlay) menuOverlay.classList.remove('open');
    document.body.style.overflow = '';
  }

  mobileMenuBtn.addEventListener('click', openMobileMenu);
  if (closeMenuBtn) closeMenuBtn.addEventListener('click', closeMobileMenu);
  if (menuOverlay) menuOverlay.addEventListener('click', closeMobileMenu);

  // Close menu when clicking a link
  mobileMenu.querySelectorAll('a').forEach(link => {
    link.addEventListener('click', closeMobileMenu);
  });

  // Close on Escape key
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && mobileMenu.classList.contains('open')) {
      closeMobileMenu();
    }
  });
}

// ===== DARK MODE TOGGLE =====
function initDarkMode() {
  const darkModeToggle = document.getElementById('dark-mode-toggle');
  const darkModeToggleMobile = document.getElementById('dark-mode-toggle-mobile');

  // Prevent duplicate initialization
  if (window._darkModeInitialized) return;
  window._darkModeInitialized = true;

  function toggleDarkMode() {
    document.documentElement.classList.toggle('dark');
    const isDark = document.documentElement.classList.contains('dark');
    setCookie('darkMode', isDark, 365);
  }

  if (darkModeToggle) darkModeToggle.addEventListener('click', toggleDarkMode);
  if (darkModeToggleMobile) darkModeToggleMobile.addEventListener('click', toggleDarkMode);
}

// ===== BACK TO TOP =====
function initBackToTop() {
  const backToTop = document.getElementById('back-to-top');
  if (!backToTop) return;

  function updateBackToTop() {
    if (window.scrollY > 500) {
      backToTop.classList.add('visible');
    } else {
      backToTop.classList.remove('visible');
    }
  }

  backToTop.addEventListener('click', () => {
    window.scrollTo({ top: 0, behavior: 'smooth' });
  });

  window.addEventListener('scroll', updateBackToTop);
}

// ===== SCROLL REVEAL =====
function initScrollReveal() {
  const revealObserver = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add('visible');
      }
    });
  }, { threshold: 0.1, rootMargin: '0px 0px -50px 0px' });

  document.querySelectorAll('.reveal, .card-hover, .stagger-children').forEach(el => {
    revealObserver.observe(el);
  });
}

// ===== SMOOTH SCROLL =====
function initSmoothScroll() {
  document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function(e) {
      const href = this.getAttribute('href');
      if (href !== '#') {
        e.preventDefault();
        const target = document.querySelector(href);
        if (target) {
          const headerOffset = 80;
          const elementPosition = target.getBoundingClientRect().top;
          const offsetPosition = elementPosition + window.scrollY - headerOffset;

          window.scrollTo({
            top: offsetPosition,
            behavior: 'smooth'
          });
        }
      }
    });
  });
}

// ===== COOKIE CONSENT EVENT LISTENERS =====
function initCookieConsentListeners() {
  // Banner buttons
  const acceptBtn = document.getElementById('cookie-accept');
  const rejectBtn = document.getElementById('cookie-reject');
  const customizeBtn = document.getElementById('cookie-customize');

  if (acceptBtn) acceptBtn.addEventListener('click', () => CookieConsent.acceptAll());
  if (rejectBtn) rejectBtn.addEventListener('click', () => CookieConsent.rejectAll());
  if (customizeBtn) customizeBtn.addEventListener('click', () => {
    CookieConsent.hideBanner();
    CookieConsent.showModal();
  });

  // Modal buttons
  const modalClose = document.getElementById('cookie-modal-close');
  const modalBackdrop = document.getElementById('cookie-modal-backdrop');
  const modalReject = document.getElementById('cookie-modal-reject');
  const modalSave = document.getElementById('cookie-modal-save');

  if (modalClose) modalClose.addEventListener('click', () => CookieConsent.hideModal());
  if (modalBackdrop) modalBackdrop.addEventListener('click', () => CookieConsent.hideModal());
  if (modalReject) modalReject.addEventListener('click', () => CookieConsent.rejectAll());
  if (modalSave) modalSave.addEventListener('click', () => CookieConsent.savePreferences());

  // Footer cookie settings button
  const cookieSettingsBtn = document.getElementById('cookie-settings-btn');
  if (cookieSettingsBtn) cookieSettingsBtn.addEventListener('click', () => CookieConsent.showModal());

  // Note: Cookie toggles are now wrapped in <label> elements, so native browser behavior handles the toggle.
  // No additional JavaScript handlers needed for the toggle switches.
}

// ===== INITIALIZE ALL =====
function initAll() {
  initMobileMenu();
  initDarkMode();
  initBackToTop();
  initScrollReveal();
  initSmoothScroll();
  initCookieConsentListeners();
  CookieConsent.init();
}

// Handle both fresh page load and cases where DOM is already ready
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', initAll);
} else {
  // DOM is already ready, initialize immediately
  initAll();
}

// Expose CookieConsent for external use
window.CookieConsent = CookieConsent;
</script>

<!-- /SHARED_SCRIPTS -->
</body>
</html>
